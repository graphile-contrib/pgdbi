(function(e){function t(t){for(var i,o,r=t[0],s=t[1],c=t[2],u=0,m=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&m.push(n[o][0]),n[o]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);d&&d(t);while(m.length)m.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],i=!0,o=1;o<a.length;o++){var s=a[o];0!==n[s]&&(i=!1)}i&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},n={app:0},l=[];function o(e){return r.p+"js/"+({about:"about",pdfjsWorker:"pdfjsWorker"}[e]||e)+"."+{about:"d5ebc69e",pdfjsWorker:"484168c6"}[e]+".js"}function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.e=function(e){var t=[],a=n[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,i){a=n[e]=[t,i]}));t.push(a[2]=i);var l,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=o(e);var c=new Error;l=function(t){s.onerror=s.onload=null,clearTimeout(u);var a=n[e];if(0!==a){if(a){var i=t&&("load"===t.type?"missing":t.type),l=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+l+")",c.name="ChunkLoadError",c.type=i,c.request=l,a[1](c)}n[e]=void 0}};var u=setTimeout((function(){l({type:"timeout",target:s})}),12e4);s.onerror=s.onload=l,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/pgdbi/",r.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=c;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0100":function(e,t,a){"use strict";var i=a("9dbb"),n=a.n(i);const l="terse";function o(e,t,a,i){const o=Object.keys(e.roleFunctionGrants).map(e=>{return{roleName:e}}),s=`${o.map(e=>e.roleName).join(", ")}`,c=Object.keys(e.roleFunctionGrants).reduce((t,a)=>{return"ALLOWED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t},[]),u=Object.keys(e.roleFunctionGrants).reduce((t,a)=>{return"IMPLIED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t},[]),d=Object.keys(e.roleFunctionGrants).reduce((t,a)=>{return"DENIED"===e.roleFunctionGrants[a].execute?t.concat([{roleName:a}]):t},[]),m={verbose:!0,deniedRoleGrants:d,impliedRoleGrants:u},p=i?i.argumentDataTypes.split(",").map(e=>e.replace("timestamp with time zone","timestamptz")).map(e=>e.trim().split(" ")[1]).join(","):void 0,h={...a,policyName:e.name,allowedRoleGrants:c,revokeRolesList:s,functionSignature:i?`${i.functionSchema}.${i.functionName} (${p})`:"{{schemaName}}.{{functionName}} ({{signatureArgumentDataTypes}})"},b=t===l?h:{...m,...h};return n.a.render(r,b)}t["a"]=o;const r="\n----------\n----------  BEGIN FUNCTION POLICY: {{functionSignature}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING FUNCTION GRANTS\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from public;\n\n  revoke all privileges \n  on function {{functionSignature}} \n  from {{revokeRolesList}};\n\n----------  CREATE NEW FUNCTION GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  execute\n  on function {{functionSignature}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n{{#verbose}}\n----------  IMPLIED FUNCTION GRANTS\n  {{#impliedRoleGrants}}\n  --IMPLIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n  --DENIED:   grant execute on function {{functionSignature}} to {{roleName}};\n  {{/deniedRoleGrants}}\n{{/verbose}}\n----------  END FUNCTION POLICY: {{functionSignature}}\n--==\n\n"},"0134":function(e,t,a){"use strict";var i=a("da37"),n=a.n(i);n.a},"015f":function(e,t,a){},"03f5":function(e,t,a){"use strict";(function(e){var i=a("82cd");t["a"]={name:"FunctionPolicyManager",components:{PolicyDefinition:i["a"]},methods:{saveNewPolicy(){try{this.$store.commit("newFunctionPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies(){return this.$store.state.functionPolicies.sort((function(e,t){return e.id<t.id?-1:1}))}},data(){return{dialog:!1,newPolicyName:"New Function Policy",headers:[{text:"",sortable:!1},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,a("f28c"))},"065f":function(e,t,a){"use strict";var i=a("9e46"),n=a.n(i);n.a},1:function(e,t){},1004:function(e,t,a){},"115f":function(e,t,a){"use strict";var i=a("d806"),n=a.n(i);n.a},2:function(e,t){},"22b5":function(e,t,a){},"243e":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""},on:{"declaration-visibility-changed":e.declarationVisibilityChanged}})],1)},n=[],l=a("89d6"),o={name:"Function",components:{ScriptViewer:l["a"]},props:{id:{type:String,required:!0},context:{type:String,default:"default"}},computed:{definition(){const e={default:this.rawFunction,trigger:this.triggerFunction};return e[this.context]},rawFunction(){return this.fn.definition},modifiedFunction(){const e=this.fn.definition.split("$function$")[0],t=this.fn.definition.split("$function$")[1],a=e.split("\n").map(e=>`-- ${e}`).join("\n");return`${a} $function$${t} -- $function$\n`},triggerFunction(){const e=this.fn.definition.split("$function$")[1];return e},functionName(){return this.fn.functionName},functionSchema(){return this.fn.functionSchema}},data:()=>({fn:{definition:""},declarationVisibility:"show"}),methods:{declarationVisibilityChanged(e){this.declarationVisibility=e},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setFn(){const e=this.id.split(".")[0],t=(this.id.split(".")[1].split("--")[0],this.$store.state.managedSchemata.find(t=>t.schemaName===e));this.fn=t.schemaFunctions.find(e=>e.id===this.id)}},mounted(){this.setFn()},beforeRouteUpdate(e,t,a){this.setFn(),a()}},r=o,s=a("2877"),c=a("6544"),u=a.n(c),d=a("a523"),m=Object(s["a"])(r,i,n,!1,null,null,null);t["a"]=m.exports;u()(m,{VContainer:d["a"]})},3:function(e,t){},"35d9":function(e,t,a){"use strict";var i=a("b450"),n=a.n(i);n.a},3754:function(e,t,a){},"3b45":function(e,t,a){},"3c04":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ExecSql"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sql"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ExecSql"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"sql"},value:{kind:"Variable",name:{kind:"Name",value:"sql"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:93}};a.loc.source={body:"mutation ExecSql(\n  $sql: String!\n){\n  ExecSql(input: {\n    sql: $sql\n  }) {\n    result\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,r=new Set;i.forEach((function(e){r.add(e)}));while(r.size>0){var s=r;r=new Set,s.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){r.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["ExecSql"]=o(a,"ExecSql")},4:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);var i=a("2b0e"),n=a("f309");i["a"].use(n["a"]);var l=new n["a"]({icons:{iconfont:"md"}}),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"","clipped-left":""}},[a("v-btn",{class:e.refreshBtnClass,attrs:{color:e.refreshBtnColor,hidden:e.initializing},on:{click:e.refreshSchemata}},[e._v("Refresh Schemata")]),a("v-spacer"),a("v-toolbar-title",{attrs:{selectable:""},domProps:{textContent:e._s(e.title)},on:{click:e.home}}),a("v-spacer"),a("v-btn",{attrs:{color:e.btnColor("home")},on:{click:function(t){return e.navigate("home")}}},[e._v("Project")]),a("v-btn",{attrs:{color:e.btnColor("security-manager"),disabled:e.initializing},on:{click:function(t){return e.navigate("security-manager")}}},[e._v("Security Scripts")]),a("v-btn",{attrs:{color:e.btnColor("search-view"),disabled:e.initializing},on:{click:function(t){return e.navigate("search-view")}}},[e._v("Function Search")]),a("v-btn",{attrs:{color:e.btnColor("pg-lint"),disabled:e.initializing},on:{click:function(t){return e.navigate("pg-lint")}}},[e._v("PG-Lint")]),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){return t.stopPropagation(),e.settings(t)}}},[a("v-icon",[e._v("settings")])],1),a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}})],1),a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){t.hover;return[a("v-navigation-drawer",{attrs:{app:"",right:"",width:400,"disable-route-watcher":""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("project-navigator")],1)]}}])}),a("v-content",[a("v-container",{attrs:{"justify-start":"","ma-0":"","pa-0":""}},[a("router-view")],1)],1),a("v-footer",{attrs:{app:""}},[a("span",[e._v("Â© 2019")])])],1)},r=[],s=a("58bb"),c=a.n(s),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("schema-navigator")],1)},d=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",fluid:""}},[a("h2",{attrs:{"text-right":""}},[e._v("schemata")]),a("schema-tree")],1)},p=[],h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",dense:""}},[a("v-treeview",{directives:[{name:"scroll",rawName:"v-scroll"}],attrs:{items:e.items,activatable:"",transition:"",active:e.active,hoverable:"",dense:""},on:{"update:active":function(t){e.active=t}},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},b=[];new i["a"];var f={name:"SchemaTree",data:()=>({active:[],schemata:[],selected:[]}),computed:{items(){return this.$store.state.managedSchemata.map(e=>{return{id:`schema:${e.id}`,name:e.schemaName,children:this.filterMode?[]:[{id:`tables:${e.schemaName}`,name:"tables",children:e.schemaTables.filter(e=>"BASE TABLE"===e.tableType).sort((e,t)=>{return e.tableName<t.tableName?-1:1}).map(e=>{return{id:`table:${e.id}`,name:e.tableName}})},{id:`views:${e.schemaName}`,name:"views",children:e.schemaTables.filter(e=>"VIEW"===e.tableType).sort((e,t)=>{return e.tableName<t.tableName?-1:1}).map(e=>{return{id:`view:${e.id}`,name:e.tableName}})},{id:`functions:${e.schemaName}`,name:"functions",children:(e.schemaFunctions||[]).sort((e,t)=>{return e.functionName<t.functionName?-1:1}).map(e=>{return{id:`function:${e.id}`,name:e.functionName}})},{id:`enums:${e.schemaName}`,name:"enums",children:(e.schemaEnums||[]).sort((e,t)=>{return e.enumName<t.enumName?-1:1}).map(e=>{return{id:`enum:${e.id}`,name:e.enumName}})},{id:`udts:${e.schemaName}`,name:"udts",children:(e.schemaUdts||[]).sort((e,t)=>{return e.udtName<t.udtName?-1:1}).map(e=>{return{id:`udt:${e.id}`,name:e.udtName}})}]}}).sort((e,t)=>{return e.name<t.name?-1:1})}},watch:{active(){const e=this.active[0]||"",t=e.split(":")[0],a=e.split(":")[1];switch(t){case"table":this.$router.push({name:"table",params:{id:a}});break;case"tables":break;case"view":this.$router.push({name:"table",params:{id:a}});break;case"views":break;case"function":this.$router.push({name:"function",params:{id:a}});break;case"enum":this.$router.push({name:"enum",params:{id:a}});break;case"udt":this.$router.push({name:"udt",params:{id:a}});break;default:break}}}},v=f,y=a("2877"),g=a("6544"),x=a.n(g),k=a("a523"),N=a("eb2a"),C=a("269a"),_=a.n(C),T=a("f977"),S=Object(y["a"])(v,h,b,!1,null,null,null),E=S.exports;x()(S,{VContainer:k["a"],VTreeview:N["a"]}),_()(S,{Scroll:T["b"]});var P={name:"SchemaNavigator",components:{SchemaTree:E},props:{},data:()=>({}),computed:{},watch:{},methods:{}},D=P,I=(a("115f"),Object(y["a"])(D,m,p,!1,null,null,null)),w=I.exports;x()(I,{VContainer:k["a"]});var R={name:"ProjectNavigator",props:{},components:{SchemaNavigator:w}},O=R,V=Object(y["a"])(O,u,d,!1,null,null,null),$=V.exports;x()(V,{VContainer:k["a"]});var A={name:"App",props:{source:String},components:{ProjectNavigator:$},computed:{initializing(){return this.$store.state.initializing},currentRoute(){return this.$router.currentRoute},disableGraphileWorker(){return!0!==(this.$store.state.pgdbiOptions||{enableGraphileWorker:!1}).enableGraphileWorker},disableSqitch(){return!0!==(this.$store.state.pgdbiOptions||{enableSqitch:!1}).enableSqitch}},watch:{initializing(){this.setRefreshBtnClass()}},methods:{setRefreshBtnClass(){this.refreshBtnClass=this.initializing?"refreshBtnInitializing":"refreshBtn",this.refreshBtnColor=this.initializing?"yellow darken-3":"blue-grey"},refreshSchemata(){this.$loading(!0),this.$apollo.query({query:c.a,fetchPolicy:"network-only"}).then(e=>{this.$store.dispatch("setManagedSchemata",{schemaTree:e.data.dbIntrospection.schemaTree,pgdbiOptions:{pgdbiOptions:e.data.pgdbiOptions}}),this.$loading(!1)}).catch(e=>{this.$loading(!1),console.error(e),alert(e.toString())})},btnColor(e){return this.$router.currentRoute.name===e?"blue":"blue-grey"},home(){this.$router.push({name:"home"})},settings(){this.$router.push({name:"settings"})},navigate(e){this.$router.push({name:e})}},data(){return{expandNav:!1,clipped:!0,drawer:!1,fixed:!1,items:[],miniVariant:!1,right:!0,rightDrawer:!1,title:"pg-db-inspector",refreshBtnClass:"refreshBtn",refreshBtnColor:"blue-grey"}},mounted(){this.setRefreshBtnClass()},created(){this.$vuetify.theme.dark=!0}},j=A,F=a("7496"),L=a("40dc"),G=a("5bc1"),q=a("8336"),U=a("a75b"),B=a("553a"),z=a("ce87"),M=a("132d"),H=a("f774"),Q=a("2fa4"),W=a("2a7f"),K=Object(y["a"])(j,o,r,!1,null,null,null),J=K.exports;x()(K,{VApp:F["a"],VAppBar:L["a"],VAppBarNavIcon:G["a"],VBtn:q["a"],VContainer:k["a"],VContent:U["a"],VFooter:B["a"],VHover:z["a"],VIcon:M["a"],VNavigationDrawer:H["a"],VSpacer:Q["a"],VToolbarTitle:W["a"]});var X=a("8c4f"),Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":"",fluid:""}},[a("h1",[e._v("PGDBI")]),a("h2",[e._v("postgraphile-db-inspector")]),a("v-toolbar",[a("project-reset-dialog"),a("v-btn",{on:{click:function(t){return e.$router.push("project-export")}}},[e._v("Export Project")])],1),a("roles")],1)},Z=[],ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"choose-role-set",attrs:{ripple:""}},[e._v("\n      Choose Role Set\n    ")]),a("v-tab-item",{key:"choose-role-set"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"choose-role-set"},[a("choose-role-set"),a("v-card-actions",[a("v-btn",{class:e.refreshBtnClass,attrs:{color:e.refreshBtnColor,hidden:!e.initializing},on:{click:e.refreshSchemata}},[e._v("Refresh Schemata")])],1)],1)],1)],1)],1)],1),a("v-tab",{key:"customize-role-set",attrs:{ripple:""}},[e._v("\n      Customize Available Role Sets\n    ")]),a("v-tab-item",{key:"customize-role-set"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"customize-role-set"},[a("customize-available-role-sets")],1)],1)],1)],1)],1)],1)],1)},te=[],ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-radio-group",{attrs:{value:e.roleSetId,row:"",disabled:!e.initializing},on:{change:e.changeRoleSet}},e._l(e.allRoleSets,(function(e){return a("v-radio",{key:e.name,attrs:{label:e.name,value:e.name}})})),1),a("v-data-table",{attrs:{items:e.mappedDbUsers,headers:e.userHeaders,"hide-default-footer":"","disable-sort":""}})],1)},ie=[];const ne="---",le="+++";var oe={name:"Roles",mixins:[],components:{},watch:{},computed:{allRoleSets(){return this.$store.state.allRoleSets},roleSetId(){return this.$store.state.roleSet.name},initializing(){return this.$store.state.initializing},dbOwner(){return this.$store.state.roleSet.dbOwnerRole},dbAuthenticator(){return this.$store.state.roleSet.dbAuthenticatorRole},dbUsers(){const e=this.$store.state.roleSet.dbUserRoles;return[this.dbOwner,this.dbAuthenticator,...e.sort((e,t)=>{return t.applicableRoles.length-e.applicableRoles.length})]},userHeaders(){return[{text:"name",value:"name"},...this.dbUsers.map(e=>{return{text:e.roleName,value:e.roleName}})]},mappedDbUsers(){return this.dbUsers.map(e=>{return this.dbUsers.reduce((t,a)=>{return e.roleName===a.roleName?{...t,[a.roleName]:e.roleName}:e.applicableRoles.map(e=>e.roleName).indexOf(a.roleName)>-1?{...t,[a.roleName]:le}:{...t,[a.roleName]:ne}},{name:e.roleName})})}},data(){return{}},methods:{changeRoleSet(e){this.$loading=!0,this.$store.dispatch("setProjectRoleSet",e).then(()=>{this.$loading=!1}).catch(e=>{console.error(e),this.$loading=!1})}},mounted(){}},re=oe,se=a("8fea"),ce=a("67b6"),ue=a("43a6"),de=Object(y["a"])(re,ae,ie,!1,null,null,null),me=de.exports;x()(de,{VContainer:k["a"],VDataTable:se["a"],VRadio:ce["a"],VRadioGroup:ue["a"]});var pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-toolbar",[a("v-btn",{on:{click:e.saveAllRoleSets}},[e._v("Save")])],1),a("v-textarea",{attrs:{"auto-grow":"",spellcheck:"false","background-color":"black"},model:{value:e.allRolesJsonText,callback:function(t){e.allRolesJsonText=t},expression:"allRolesJsonText"}})],1)},he=[],be={name:"CustomizeAvailableRoleSets",mixins:[],components:{},props:{},data(){return{allRolesJsonText:""}},watch:{allRoleSets(){this.computeContent()}},methods:{computeContent(){this.allRolesJsonText=JSON.stringify(this.allRoleSets,0,2)},saveAllRoleSets(){const e=JSON.parse(this.allRolesJsonText);this.$store.commit("setAllRoleSets",e)}},computed:{allRoleSets(){return this.$store.state.allRoleSets}},mounted(){this.computeContent()}},fe=be,ve=a("a844"),ye=a("71d9"),ge=Object(y["a"])(fe,pe,he,!1,null,null,null),xe=ge.exports;x()(ge,{VBtn:q["a"],VContainer:k["a"],VTextarea:ve["a"],VToolbar:ye["a"]});var ke={name:"Roles",mixins:[],components:{ChooseRoleSet:me,CustomizeAvailableRoleSets:xe},watch:{},computed:{initializing(){return this.$store.state.initializing}},data(){return{activeTab:null,refreshBtnClass:"refreshBtnInitializing",refreshBtnColor:"yellow darken-3"}},methods:{refreshSchemata(){this.$loading(!0),this.$apollo.query({query:c.a,fetchPolicy:"network-only"}).then(e=>{this.$store.dispatch("setManagedSchemata",{schemaTree:e.data.dbIntrospection.schemaTree,pgdbiOptions:{pgdbiOptions:e.data.pgdbiOptions}}),this.$loading(!1)}).catch(e=>{this.$loading(!1),console.error(e),alert(e.toString())})}},mounted(){}},Ne=ke,Ce=a("b0af"),_e=a("99d9"),Te=a("0e8f"),Se=a("a722"),Ee=a("71a3"),Pe=a("c671"),De=a("fe57"),Ie=Object(y["a"])(Ne,ee,te,!1,null,null,null),we=Ie.exports;x()(Ie,{VBtn:q["a"],VCard:Ce["a"],VCardActions:_e["a"],VContainer:k["a"],VFlex:Te["a"],VLayout:Se["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{dark:""}},i),[e._v("\n        RESET PGDBI\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-text",[e._v("Are you sure you want to reset PGDBI?")]),a("v-card-text",[e._v("This will discard all policy definitions and assignement")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.navToExport}},[e._v("Save Project")]),a("v-btn",{on:{click:e.resetPgdbi}},[e._v("Exterminate!")]),a("v-spacer")],1)],1)],1)],1)},Oe=[],Ve={name:"ProjectResetDialog",props:{},mounted(){},data(){return{dialog:!1}},computed:{},watch:{},methods:{resetPgdbi(){this.$store.dispatch("resetDefaultState"),this.$router.push("initialize")},navToExport(){this.$router.push("project-export")}},mounted(){}},$e=Ve,Ae=(a("8c37"),a("169a")),je=Object(y["a"])($e,Re,Oe,!1,null,null,null),Fe=je.exports;x()(je,{VBtn:q["a"],VCard:Ce["a"],VCardActions:_e["a"],VCardText:_e["b"],VDialog:Ae["a"],VSpacer:Q["a"]});var Le={name:"Home",components:{Roles:we,ProjectResetDialog:Fe},props:{},computed:{},data:()=>({activeTab:null}),methods:{}},Ge=Le,qe=Object(y["a"])(Ge,Y,Z,!1,null,null,null),Ue=qe.exports;x()(qe,{VBtn:q["a"],VContainer:k["a"],VToolbar:ye["a"]});var Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-5":"","pa-5":""}},[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"initialize",attrs:{ripple:""}},[e._v("\n      Initialize Project\n    ")]),a("v-tab-item",{key:"initialize"},[a("v-card",[a("roles")],1)],1),a("v-tab",{key:"import",attrs:{ripple:""}},[e._v("\n      Import Project\n    ")]),a("v-tab-item",{key:"import"},[a("v-card",[a("project-import")],1)],1)],1)],1)},ze=[],Me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"container"},[a("div",{staticClass:"large-12 medium-12 small-12 cell"},[a("label",[e._v("File\n        "),a("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:function(t){return e.handleFileUpload()}}})])])]),a("h1",[e._v("Import Project: "+e._s(e.projectName))]),a("v-toolbar",[a("v-btn",{on:{click:e.importProject}},[e._v("Import")])],1),a("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},He=[],Qe={name:"ImportProject",components:{},props:{},computed:{projectName(){return this.project?this.project.name:"N/A"},projectJson(){return this.project?JSON.stringify(this.project,null,2):"N/A"}},methods:{importProject:function(){this.$store.commit("importProject",{project:this.project})},useResults(e){this.project=JSON.parse(e.currentTarget.result)},handleFileUpload(){this.file=this.$refs.file.files[0];const e=new FileReader;e.onload=this.useResults,e.readAsText(this.file)},submitFile(){}},data(){return{file:"",project:{releases:{nodes:[]}}}}},We=Qe,Ke=Object(y["a"])(We,Me,He,!1,null,null,null),Je=Ke.exports;x()(Ke,{VBtn:q["a"],VTextarea:ve["a"],VToolbar:ye["a"]});var Xe={name:"Initialize",components:{ProjectImport:Je,Roles:we},props:{},computed:{initializing(){return this.$store.state.initializing}},data:()=>({activeTab:null}),methods:{},watch:{initializing(){!0!==this.initializing&&this.$router.push({name:"security-manager"})}},beforeRouteLeave(e,t,a){this.initializing?a(!1):a()}},Ye=Xe,Ze=Object(y["a"])(Ye,Be,ze,!1,null,null,null),et=Ze.exports;x()(Ze,{VCard:Ce["a"],VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var tt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"cols",attrs:{ripple:""}},[e._v("\n      Columns\n    ")]),a("v-tab-item",{key:"cols"},[a("v-card",{attrs:{flat:""}},[a("table-columns",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"constraints-and-indices",attrs:{ripple:""}},[e._v("\n      Constraints and Indices\n    ")]),a("v-tab-item",{key:"constraints-and-indices"},[a("v-card",{attrs:{flat:""}},[a("constraints-and-indices",{attrs:{tableSchema:e.tableSchema,tableName:e.tableName}})],1)],1),a("v-tab",{key:"tabletriggers",attrs:{ripple:""}},[e._v("\n      Triggers\n    ")]),a("v-tab-item",{key:"tabletriggers"},[a("v-card",{attrs:{flat:""}},[a("table-triggers",{attrs:{triggers:e.tableTriggers}})],1)],1),a("v-tab",{key:"tablePolicy",attrs:{ripple:""}},[e._v("\n      Assigned Policy\n    ")]),a("v-tab-item",{key:"tablePolicy"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition",{attrs:{policyId:e.tableInfo.policyDefinitionId,table:e.tableInfo}})],1)],1),a("v-tab",{key:"tableScripts",attrs:{ripple:""}},[e._v("\n      Generated Scripts\n    ")]),a("v-tab-item",{key:"tableScripts"},[a("v-card",{attrs:{flat:""}},[a("table-scripts",{attrs:{tableInfo:e.tableInfo}})],1)],1)],1)],1)},at=[],it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.fkInfo",fn:function(t){var a=t.item;return[e._v("\n    "+e._s(a.fkInfo)+"\n  ")]}},{key:"item.fkIndex",fn:function(t){var i=t.item;return[a("div",{class:e.fkIndexClass(i.fkIndex)},[i.fkIndexLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkIndexLinkId}},target:"_blank"}},[e._v(e._s(i.fkIndex))]):e._e(),i.fkIndexLinkId?e._e():a("span",[e._v(e._s(i.fkIndex))])],1)]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("column-detail",{attrs:{columnInfo:t.item}})],1)]}}])})],1)},nt=[],lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-row",{staticClass:"blue darken-4"},[a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{outlined:"",tile:""}},[a("h4",[e._v("Indices")]),a("hr"),e._l(e.columnInfo.columnIndices,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.indexName)+"\n            ")])}))],2)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[a("h4",[e._v("Foreign Keys")]),a("hr"),e._l(e.columnInfo.fkConstraintUsage,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),a("hr"),e._v("\n              REF: "),t.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:t.fkTableLinkId}},target:"_blank"}},[e._v(e._s(t.fkPath))]):e._e(),a("hr"),e._v("\n              IDX: "),a("span",{class:e.fkIndexClass(t.fkIndexEvaluation)},[e._v(e._s(t.fkIndexEvaluation))])],1)}))],2)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{staticClass:"ma-1 pa-1",attrs:{dense:""}},[a("h4",[e._v("Unique Constraints")]),a("hr"),e._l(e.columnInfo.uqConstraintUsage,(function(t){return a("v-card",{key:t.id,staticClass:"ma-1 pa-1 grey darken-4 text-no-wrap"},[e._v("\n              "+e._s(t.constraintName)+"\n              "),a("hr"),e._v("\n              IDX: "),a("span",{class:e.uqIndexClass(t.uqIndexEvaluation)},[e._v(e._s(t.uqIndexEvaluation))])])}))],2)],1)],1)],1)],1)],1)},ot=[];const rt="NO INDEX",st="MULTIPLE_INDICES";var ct={name:"ColumnDetail",props:{columnInfo:{type:Object,required:!0}},methods:{fkIndexClass(e){return e===rt?"red--text":e===st?"yellow--text":"green--text"},uqIndexClass(e){return e===rt?"red--text":e===st?"yellow--text":"green--text"}}},ut=ct,dt=a("62ad"),mt=a("0fd9"),pt=Object(y["a"])(ut,lt,ot,!1,null,null,null),ht=pt.exports;x()(pt,{VCard:Ce["a"],VCol:dt["a"],VContainer:k["a"],VRow:mt["a"]});const bt="NO INDEX";var ft={name:"TableDetail",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:ht},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass(e){return e===bt?"red--text":""}},computed:{tableDetail(){console.log("table",this.tableInfo);const e=(this.tableInfo.tableColumns||[]).map(e=>{const t=((this.tableInfo.referentialConstraints||[]).find(t=>{return void 0!==t.referencingColumnUsage.find(t=>t.tableSchema===e.tableSchema&&t.tableName===e.tableName&&t.columnName===e.columnName)})||{referencedColumnUsage:[]}).referencedColumnUsage[0],a=t?`${t.tableSchema}.${t.tableName}.${t.columnName}`:"",i=this.tableInfo.indices.find(t=>t.tableSchema===e.tableSchema&&t.tableName===e.tableName&&t.columnName===e.columnName),n=t?i?`${i.indexName}`:bt:"",l=t&&n!==bt?`table:${t.tableSchema}.${t.tableName}`:"";return{...e,fkInfo:a,fkIndex:n,fkIndexLinkId:l}});return e}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Identity",sortable:!0,value:"isIdentity"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Default Value",sortable:!0,value:"columnDefault"},{text:"FK Reference",sortable:!0,value:"fkInfo"},{text:"FK Index",sortable:!0,value:"fkIndex"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},vt=ft,yt=Object(y["a"])(vt,it,nt,!1,null,null,null),gt=yt.exports;x()(yt,{VContainer:k["a"],VDataTable:se["a"]});var xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","calculate-widths":"",dense:"","items-per-page":100},scopedSlots:e._u([{key:"item.isPKColumn",fn:function(t){var i=t.item;return[i.isPKColumn?a("v-icon",[e._v("check")]):e._e()]}},{key:"item.isNullable",fn:function(t){var i=t.item;return["YES"===i.isNullable?a("v-icon",[e._v("check")]):e._e()]}}])})],1)},kt=[];const Nt="NO INDEX",Ct="MULTIPLE_INDICES";var _t={name:"TableColumns",props:{tableInfo:{type:Object,required:!0}},components:{ColumnDetail:ht},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)},fkIndexClass(e){const t=e.fkConstraintUsage.filter(e=>e.fkIndexEvaluation===Nt).length,a=e.fkConstraintUsage.filter(e=>e.fkIndexEvaluation===Ct).length;return t>0?"red":a>0?"yellow":"green"},uqIndexClass(e){const t=e.uqConstraintUsage.filter(e=>e.uqIndexEvaluation===Nt).length,a=e.uqConstraintUsage.filter(e=>e.uqIndexEvaluation===Ct).length;return t>0?"red":a>0?"yellow":"green"}},computed:{tableDetail(){const e=(this.tableInfo.primaryKeyConstraints||[]).reduce((e,t)=>{const a=t.keyColumnUsage.reduce((e,t)=>{return[...e,t.columnName]},[]);return[...e,...a]},[]),t=(this.tableInfo.tableColumns||[]).map(t=>{const a=this.tableInfo.indices.filter(e=>e.tableSchema===t.tableSchema&&e.tableName===t.tableName&&e.columnName===t.columnName),i=e.indexOf(t.columnName)>-1,n=this.$store.state.fkIndexEvaluations.singleColumn[`${t.tableSchema}.${t.tableName}.${t.columnName}`],l=this.$store.state.uqIndexEvaluations[`${t.tableSchema}.${t.tableName}.${t.columnName}`];return{...t,fkConstraintUsage:n||[],uqConstraintUsage:l||[],isPKColumn:i,columnIndices:a}});return t}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"PK",sortable:!0,value:"isPKColumn"},{text:"Nullable",sortable:!0,value:"isNullable"},{text:"Data Type",sortable:!0,value:"dataType"},{text:"Default Value",sortable:!0,value:"columnDefault"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},Tt=_t,St=Object(y["a"])(Tt,xt,kt,!1,null,null,null),Et=St.exports;x()(St,{VContainer:k["a"],VDataTable:se["a"],VIcon:M["a"]});var Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),a("v-tab-item",{key:"allIndices"},[a("v-card",{attrs:{flat:""}},[a("table-generic-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),a("v-tab-item",{key:"fkIndices"},[a("v-card",{attrs:{flat:""}},[a("table-fk-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),a("v-tab-item",{key:"uqIndices"},[a("v-card",{attrs:{flat:""}},[a("table-uq-indices",{attrs:{tableInfo:e.tableInfo}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n    Check Constraints\n  ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1)],1)},Dt=[],It=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[a("h2",[e._v("Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.evaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.evaluation))])]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[a("h2",[e._v("Over-Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.columnDisplay",fn:function(t){var i=t.item;return e._l(i.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.evaluation))])]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},wt=[],Rt=a("89d6"),Ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n          Create\n          ")]),a("v-tab-item",{key:"create"},[a("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1}})],1),a("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n          Drop\n          ")]),a("v-tab-item",{key:"drop"},[a("script-viewer",{attrs:{scriptText:t.item.indexDrop,showReadability:!1}})],1)],1)],1)]}}])})],1)},Vt=[],$t={name:"TableGenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:Rt["a"]},methods:{},computed:{},data:()=>({headers:[{text:"Index Name",value:"indexName"}]})},At=$t,jt=Object(y["a"])(At,Ot,Vt,!1,null,null,null),Ft=jt.exports;x()(jt,{VContainer:k["a"],VDataTable:se["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});const Lt="MULTIPLE_INDICES";var Gt={name:"TableGenericIndices",props:{tableInfo:{type:Object,required:!0}},components:{TableGenericIndexDetail:Ft},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{items(){const e=this.$store.state.genericIndexEvaluations;return Object.keys(e).filter(t=>e[t].tableKey===`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`).map(t=>e[t])},goodIndices(){return this.items.filter(e=>e.evaluation!==Lt)},badIndices(){return this.items.filter(e=>e.evaluation===Lt).map(e=>{return{...e,columnDisplay:e.idxColumns}})},duplicateIndexSets(){return this.tableInfo.indices.reduce((e,t)=>{},[])}},data:()=>({selected:[],headers:[{text:"Index Columns",value:"columnDisplay"},{text:"Evaluation",value:"evaluation"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},qt=Gt,Ut=Object(y["a"])(qt,It,wt,!1,null,null,null),Bt=Ut.exports;x()(Ut,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[a("h2",[e._v("Single-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.multiColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Mt=[],Ht={name:"TableFKIndices",components:{TableGenericIndexDetail:Ft},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return this.tableInfo.tableColumns.reduce((e,t)=>{const a=this.$store.state.fkIndexEvaluations.singleColumn[t.id];return a?[...e,...a]:e},[])},multiColumnItems(){return this.$store.state.fkIndexEvaluations.multiColumn[this.tableInfo.id]}},data:()=>({singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"fkIndexEvaluation"},{text:"FK Table",value:"fkTable"},{text:"FK Source",value:"fkSource"},{text:"FK Target",value:"fkTarget"}]})},Qt=Ht,Wt=Object(y["a"])(Qt,zt,Mt,!1,null,null,null),Kt=Wt.exports;x()(Wt,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var Jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[a("h2",[e._v("Single-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.singleColumnHeaders,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.multiColumnHeaders,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:""},scopedSlots:e._u([{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.singleColumnHeaders.length+1}},[a("table-generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Xt=[],Yt={name:"TableUqIndices",components:{TableGenericIndexDetail:Ft},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return this.tableInfo.tableColumns.reduce((e,t)=>{const a=this.$store.state.uqIndexEvaluations.singleColumn[t.id];return a?[...e,...a]:e},[])},multiColumnItems(){return this.$store.state.uqIndexEvaluations.multiColumn[this.tableInfo.id]}},data:()=>({singleColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column",value:"uqSource"}],multiColumnHeaders:[{text:"Constraint Name",value:"constraintName"},{text:"Index",value:"uqIndexEvaluation"},{text:"Uq Column(s)",value:"uqSource"}]})},Zt=Yt,ea=Object(y["a"])(Zt,Jt,Xt,!1,null,null,null),ta=ea.exports;x()(ea,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var aa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[a("h2",[e._v("Check Constraints")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},ia=[],na={name:"TableCheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.checkConstraints.map(e=>{return{...e,expanded:!1,tableName:e.tableConstraints[0].tableName}})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},la=na,oa=Object(y["a"])(la,aa,ia,!1,null,null,null),ra=oa.exports;x()(oa,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var sa={name:"TableIndexAnalysis",components:{TableGenericIndices:Bt,TableFkIndices:Kt,TableUqIndices:ta,TableCheckConstraints:ra},props:{tableInfo:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{allIndices(){return this.tableInfo.indices},uqIndices(){return this.tableInfo.indices},checkConstraints(){return this.tableInfo.checkConstraints||[]}},data:()=>({activeTab:0,headers:[{text:"Column",value:"columnName"},{text:"Index Name",value:"indexName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},ca=sa,ua=Object(y["a"])(ca,Pt,Dt,!1,null,null,null),da=ua.exports;x()(ua,{VCard:Ce["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"refcons",attrs:{ripple:""}},[e._v("\n        Referential Constraints\n      ")]),a("v-tab-item",{key:"refcons"},[a("v-card",{attrs:{flat:""}},[a("table-referential-constraints",{attrs:{referentialConstraints:e.referentialConstraints}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:""}},[e._v("\n        Check Constraints\n      ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("table-check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),a("v-tab",{key:"uq",attrs:{ripple:""}},[e._v("\n        Unique Constraints\n      ")]),a("v-tab-item",{key:"uq"},[a("v-card",{attrs:{flat:""}},[a("table-unique-constraints",{attrs:{uniqueConstraints:e.uniqueConstraints}})],1)],1)],1)],1)},pa=[],ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0,"item-key":"constraintName"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",{on:{click:function(e){t.expanded=!t.expanded}}},[a("td",[e._v(e._s(t.item.constraintName)),a("hr"),e._v(e._s(t.item.source))]),a("td",[e._v(e._s(t.item.uniqueConstraintName)),a("hr"),e._v(e._s(t.item.target))]),a("td",[e._v(e._s(t.item.matchOption))]),a("td",[e._v(e._s(t.item.updateRule))]),a("td",[e._v(e._s(t.item.deleteRule))])])]}},{key:"expand",fn:function(t){return[a("v-card",{attrs:{flat:""}},[a("h2",[e._v("Source")]),a("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencingColumnUsage}})],1),a("v-card",{attrs:{flat:""}},[a("h2",[e._v("Target")]),a("table-key-column-usage",{attrs:{keyColumnUsage:t.item.referencedColumnUsage}})],1)]}}])})],1)},ba=[],fa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.keyColumnUsage,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.tableSchema))]),a("td",[e._v(e._s(t.item.tableName))]),a("td",[e._v(e._s(t.item.columnName))])]}}])})],1)},va=[],ya={name:"TableKeyColumnUsage",props:{keyColumnUsage:{type:Array,required:!0}},methods:{},data:()=>({headers:[{text:"Schema",sortable:!1,value:"tableSchema"},{text:"Table",sortable:!1,value:"tableName"},{text:"Column",sortable:!1,value:"columnName"}]})},ga=ya,xa=Object(y["a"])(ga,fa,va,!1,null,null,null),ka=xa.exports;x()(xa,{VContainer:k["a"],VDataTable:se["a"]});var Na={name:"TableReferentialConstraints",components:{TableKeyColumnUsage:ka},props:{referentialConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.referentialConstraints.map(e=>{return{...e,expanded:!1,source:`${e.referencingColumnUsage[0].tableSchema}.${e.referencingColumnUsage[0].tableName}.${e.referencingColumnUsage[0].columnName}`,target:`${e.referencedColumnUsage[0].tableSchema}.${e.referencedColumnUsage[0].tableName}.${e.referencedColumnUsage[0].columnName}`}})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Source Constraint",sortable:!0,value:"constraintName"},{text:"Target Constraint",sortable:!0,value:"uniqueConstraintName"},{text:"On Match",sortable:!0,value:"matchOption"},{text:"On Update",sortable:!0,value:"updateRule"},{text:"On Delete",sortable:!0,value:"deleteRule"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Ca=Na,_a=Object(y["a"])(Ca,ha,ba,!1,null,null,null),Ta=_a.exports;x()(_a,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var Sa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.uniqueConstraints,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.constraintSchema))]),a("td",[e._v(e._s(t.item.constraintName))])]}}])})],1)},Ea=[],Pa={name:"TableUniqueConstraints",props:{uniqueConstraints:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Schema",sortable:!0,value:"constraintSchema"},{text:"Name",sortable:!0,value:"constraintName"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Da=Pa,Ia=Object(y["a"])(Da,Sa,Ea,!1,null,null,null),wa=Ia.exports;x()(Ia,{VContainer:k["a"],VDataTable:se["a"]});var Ra={name:"TableConstraints",components:{TableReferentialConstraints:Ta,TableCheckConstraints:ra,TableUniqueConstraints:wa},props:{tableInfo:{type:Object,required:!0}},computed:{referentialConstraints(){return this.tableInfo.referentialConstraints||[]},checkConstraints(){return this.tableInfo.checkConstraints||[]},uniqueConstraints(){return this.tableInfo.uniqueConstraints||[]}},methods:{},data:()=>({activeTab:null})},Oa=Ra,Va=Object(y["a"])(Oa,ma,pa,!1,null,null,null),$a=Va.exports;x()(Va,{VCard:Ce["a"],VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Aa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.grantee))]),a("td",[e._v(e._s(t.item.privilegeType))])]}}])})],1)},ja=[],Fa={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},La=Fa,Ga=Object(y["a"])(La,Aa,ja,!1,null,null,null),qa=Ga.exports;x()(Ga,{VContainer:k["a"],VDataTable:se["a"]});var Ua=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.grants,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.tableSchema))]),a("td",[e._v(e._s(t.item.tableName))]),a("td",[e._v(e._s(t.item.columnName))]),a("td",[e._v(e._s(t.item.grantee))]),a("td",[e._v(e._s(t.item.grantor))]),a("td",[e._v(e._s(t.item.privilegeType))]),a("td",[e._v(e._s(t.item.isGrantable))])]}}])})],1)},Ba=[],za={name:"TableGrants",props:{grants:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Schema",sortable:!0,value:"tableSchema"},{text:"Table",sortable:!0,value:"tableName"},{text:"Column",sortable:!0,value:"columnName"},{text:"Grantee",sortable:!0,value:"grantee"},{text:"Grantor",sortable:!0,value:"grantor"},{text:"Privilege Type",sortable:!0,value:"privilegeType"},{text:"Is Grantable",sortable:!0,value:"isGrantable"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Ma=za,Ha=Object(y["a"])(Ma,Ua,Ba,!1,null,null,null),Qa=Ha.exports;x()(Ha,{VContainer:k["a"],VDataTable:se["a"]});var Wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.policies,"hide-default-footer":!0},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.policyName))]),a("td",[e._v(e._s(t.item.roles))]),a("td",[e._v(e._s(t.item.cmd))]),a("td",[e._v(e._s(t.item.qual))]),a("td",[e._v(e._s(t.item.withCheck))])]}}])})],1)},Ka=[],Ja={name:"TablePolicies",props:{policies:{type:Array,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Policy Name",sortable:!0,value:"policyName"},{text:"Roles",sortable:!0,value:"roles"},{text:"Cmd",sortable:!0,value:"cmd"},{text:"Qual",sortable:!0,value:"qual"},{text:"With Check",sortable:!0,value:"withCheck"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Xa=Ja,Ya=Object(y["a"])(Xa,Wa,Ka,!1,null,null,null),Za=Ya.exports;x()(Ya,{VContainer:k["a"],VDataTable:se["a"]});var ei=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("table-trigger-set",{staticClass:"pa-1 ma-1 green",attrs:{actionTiming:"BEFORE",eventManipulation:"INSERT",triggers:e.beforeInsert}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-2",attrs:{actionTiming:"BEFORE",eventManipulation:"UPDATE",triggers:e.beforeUpdate}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 green darken-4",attrs:{actionTiming:"BEFORE",eventManipulation:"DELETE",triggers:e.beforeDelete}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue",attrs:{actionTiming:"AFTER",eventManipulation:"INSERT",triggers:e.afterInsert}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-2",attrs:{actionTiming:"AFTER",eventManipulation:"UPDATE",triggers:e.afterUpdate}}),a("table-trigger-set",{staticClass:"pa-1 ma-1 blue darken-4",attrs:{actionTiming:"AFTER",eventManipulation:"DELETE",triggers:e.afterDelete}})],1)},ti=[],ai=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h4",[e._v(e._s(e.actionTiming)+" - "+e._s(e.eventManipulation))]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedTriggers,"hide-default-footer":!0,"item-key":"id","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("function",{attrs:{id:t.item.functionId,context:"trigger"}})],1)]}}])})],1)},ii=[],ni=a("243e"),li={name:"TableTriggers",props:{actionTiming:{type:String,required:!0},eventManipulation:{type:String,required:!0},triggers:{type:Array,required:!0}},components:{Function:ni["a"]},computed:{mappedTriggers(){return this.triggers.map(e=>{const t=`${e.actionStatement.split(" ")[2].split("(")[0]}`;return{...e,functionId:t}}).sort((e,t)=>{return e.actionTiming<t.actionTiming})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"triggerName",width:"20%"},{text:"Timing",sortable:!0,value:"actionTiming",width:"10%"},{text:"Trigger On",sortable:!0,value:"eventManipulation",width:"10%"},{text:"Statement",sortable:!0,value:"actionStatement",width:"60%"}],pagination:{sortBy:"triggerName",rowsPerPage:-1}})},oi=li,ri=Object(y["a"])(oi,ai,ii,!1,null,null,null),si=ri.exports;x()(ri,{VContainer:k["a"],VDataTable:se["a"]});var ci={name:"TableTriggers",props:{triggers:{type:Array,required:!0}},components:{TableTriggerSet:si},computed:{beforeInsert(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"INSERT"===e.eventManipulation)},beforeUpdate(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"UPDATE"===e.eventManipulation)},beforeDelete(){return this.triggers.filter(e=>"BEFORE"===e.actionTiming&&"DELETE"===e.eventManipulation)},afterInsert(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"INSERT"===e.eventManipulation)},afterUpdate(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"UPDATE"===e.eventManipulation)},afterDelete(){return this.triggers.filter(e=>"AFTER"===e.actionTiming&&"DELETE"===e.eventManipulation)}}},ui=ci,di=Object(y["a"])(ui,ei,ti,!1,null,null,null),mi=di.exports;x()(di,{VContainer:k["a"]});var pi=a("861c"),hi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"allIndices",attrs:{ripple:""}},[e._v("\n    All Indices\n  ")]),a("v-tab-item",{key:"allIndices"},[a("v-card",{attrs:{flat:""}},[a("generic-index-set",{attrs:{indexEvaluations:e.allIndexEvaluations}})],1)],1),a("v-tab",{key:"fkIndices",attrs:{ripple:""}},[e._v("\n    Foreign Key Constraints\n  ")]),a("v-tab-item",{key:"fkIndices"},[a("v-card",{attrs:{flat:""}},[a("fk-index-constraints",{attrs:{fkIndexEvaluations:e.fkIndexEvaluations}})],1)],1),a("v-tab",{key:"uqIndices",attrs:{ripple:""}},[e._v("\n    Unique Constraints\n  ")]),a("v-tab-item",{key:"uqIndices"},[a("v-card",{attrs:{flat:""}},[a("uq-index-set",{attrs:{uqIndexEvaluations:e.uqIndexEvaluations}})],1)],1),a("v-tab",{key:"chk",attrs:{ripple:"",hidden:e.hideCheckConstraints}},[e._v("\n    Check Constraints\n  ")]),a("v-tab-item",{key:"chk"},[a("v-card",{attrs:{flat:""}},[a("check-constraints",{attrs:{checkConstraints:e.checkConstraints}})],1)],1),a("v-tab",{key:"drop",attrs:{ripple:""}},[e._v("\n    Create Indices Script\n  ")]),a("v-tab-item",{key:"drop"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.createIndicesScript,skipFormat:""}})],1)],1),a("v-tab",{key:"create",attrs:{ripple:""}},[e._v("\n    Drop Indices Script\n  ")]),a("v-tab-item",{key:"create"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.dropIndicesScript}})],1)],1)],1)},bi=[],fi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[e.badIndices.length>0?a("v-card",{staticClass:"ma-3 pa-3 red darken-3",attrs:{dense:""}},[a("h2",[e._v("Over-Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.badIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.badIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var i=t.item;return[i.tableKey?a("router-link",{attrs:{to:{name:"table",params:{id:i.tableKey}},target:"_blank"}},[e._v(e._s(i.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var i=t.item;return e._l(i.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var i=t.item;return e._l(i.evaluation,(function(t){return a("div",{key:t,class:i.indexDisplayClass},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}],null,!1,589962001)})],1):e._e(),a("v-card",{staticClass:"ma-3 pa-3 green darken-3",attrs:{dense:""}},[a("h2",[e._v("Indexed")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{items:e.goodIndices,headers:e.headers,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.goodIndices.length},scopedSlots:e._u([{key:"item.tableSchema",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableKey.split(".")[0])+"\n      ")]}},{key:"item.tableName",fn:function(t){var i=t.item;return[i.tableKey?a("router-link",{attrs:{to:{name:"table",params:{id:i.tableKey}},target:"_blank"}},[e._v(e._s(i.tableKey.split(".")[1]))]):e._e()]}},{key:"item.columnDisplay",fn:function(t){var i=t.item;return e._l(i.columnDisplay,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.evaluation",fn:function(t){var i=t.item;return e._l(i.evaluation,(function(t){return a("div",{key:t,class:i.indexDisplayClass},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},vi=[],yi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h2",[e._v("Existing Indices")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.evaluation.indices,"hide-default-footer":!0,"show-expand":"","show-select":""},on:{"item-selected":e.itemSelected},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("h2",[e._v("Current Realization in Database Under Development")]),a("script-viewer",{attrs:{scriptText:t.item.indexDefinition,showReadability:!1,showToolbar:!1}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("template",{slot:"header.data-table-select"},[e._v("\n      Drop\n    ")])],2),a("h2",[e._v("Current Realization To Be Generated")]),a("script-viewer",{attrs:{scriptText:e.desiredRealization,showReadability:!1}})],1)},gi=[],xi={name:"GenericIndexDetail",props:{evaluation:{type:Object,required:!0}},components:{ScriptViewer:Rt["a"]},methods:{itemSelected(e){this.$store.commit("toggleIndexForDrop",e)}},computed:{existingIndices(){return this.evaluation.indices||[]},desiredRealization(){const e=this.evaluation.desiredRealization.drop?`-- INDICES TO DROP\n\n ${this.evaluation.desiredRealization.drop}`:"",t=this.evaluation.desiredRealization.create?`-- INDICES TO CREATE\n\n ${this.evaluation.desiredRealization.create}`:"",a=e.concat("\n\n").concat(t);return a}},data:()=>({selected:[],headers:[{text:"",value:"drop",width:"5%"},{text:"Index Name",value:"indexName"}]}),mounted(){this.evaluation.indices.map(e=>e.indexName);this.selected=this.evaluation.indices.filter(e=>void 0!==this.$store.state.indicesToDrop[e.indexName])}},ki=xi,Ni=Object(y["a"])(ki,yi,gi,!1,null,null,null),Ci=Ni.exports;x()(Ni,{VContainer:k["a"],VDataTable:se["a"]});const _i="MULTIPLE_INDICES";var Ti={name:"GenericIndexSet",props:{indexEvaluations:{type:Array,required:!0}},components:{GenericIndexDetail:Ci},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{goodIndices(){return this.indexEvaluations.filter(e=>e.evaluation!==_i).map(e=>{return{...e,columnDisplay:e.idxColumns,evaluation:e.evaluation.split(", ")}})},badIndices(){return this.indexEvaluations.filter(e=>e.evaluation===_i).map(e=>{return{...e,columnDisplay:e.idxColumns,evaluation:e.evaluation.split(", ")}})}},data:()=>({selected:[],headers:[{text:"Schema",value:"tableSchema",width:"10%"},{text:"Table",value:"tableName",width:"10%"},{text:"Index Columns",value:"columnDisplay",width:"40%"},{text:"Evaluation",value:"evaluation",width:"40%"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},Si=Ti,Ei=Object(y["a"])(Si,fi,vi,!1,null,null,null),Pi=Ei.exports;x()(Ei,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var Di=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue-grey",attrs:{dense:""}},[a("h2",[e._v("Single-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 blue-grey darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Foreign Keys")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.fkIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.fkIndexEvaluation))])]}},{key:"item.fkTable",fn:function(t){var i=t.item;return[i.fkTableLinkId?a("router-link",{attrs:{to:{name:"table",params:{id:i.fkTableLinkId}},target:"_blank"}},[e._v(e._s(i.fkTable))]):e._e()]}},{key:"item.fkSource",fn:function(t){var i=t.item;return e._l(i.fkSource,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"item.fkTarget",fn:function(t){var i=t.item;return e._l(i.fkTarget,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Ii=[],wi={name:"FkIndexConstraints",components:{GenericIndexDetail:Ci},props:{fkIndexEvaluations:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return Object.values(this.fkIndexEvaluations.singleColumn).flat()},multiColumnItems(){return Object.values(this.fkIndexEvaluations.multiColumn).filter(e=>e.length>0).flat()}},data:()=>({headers:[{text:"Constraint Name",value:"constraintName",width:"15%"},{text:"FK Table",value:"fkTable",width:"15%"},{text:"FK Source",value:"fkSource",width:"25%"},{text:"FK Target",value:"fkTarget",width:"25%"},{text:"Index",value:"fkIndexEvaluation",width:"20%"}]})},Ri=wi,Oi=Object(y["a"])(Ri,Di,Ii,!1,null,null,null),Vi=Oi.exports;x()(Oi,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var $i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 purple",attrs:{dense:""}},[a("h2",[e._v("Single-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.singleColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.singleColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var i=t.item;return[i.uqTableId?a("router-link",{attrs:{to:{name:"table",params:{id:i.uqTableId}},target:"_blank"}},[e._v(e._s(i.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1),a("v-card",{staticClass:"ma-3 pa-3 purple darken-4",attrs:{dense:""}},[a("h2",[e._v("Multi-Column Unique Indices")]),a("hr"),a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.multiColumnItems,"hide-default-footer":"","show-expand":"","calculate-widths":"",dense:"","items-per-page":e.multiColumnItems.length},scopedSlots:e._u([{key:"item.uqTableId",fn:function(t){var i=t.item;return[i.uqTableId?a("router-link",{attrs:{to:{name:"table",params:{id:i.uqTableId}},target:"_blank"}},[e._v(e._s(i.uqTableId))]):e._e()]}},{key:"item.uqIndexEvaluation",fn:function(t){var i=t.item;return[a("span",{class:i.indexDisplayClass},[e._v(e._s(i.uqIndexEvaluation))])]}},{key:"item.uqSource",fn:function(t){var i=t.item;return e._l(i.idxColumns,(function(t){return a("div",{key:t},[e._v(e._s(t))])}))}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("generic-index-detail",{attrs:{evaluation:t.item}})],1)]}}])})],1)],1)},Ai=[],ji={name:"TableUqIndices",components:{GenericIndexDetail:Ci},props:{uqIndexEvaluations:{type:Object,required:!0}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},computed:{singleColumnItems(){return Object.values(this.uqIndexEvaluations.singleColumn).flat()},multiColumnItems(){return Object.values(this.uqIndexEvaluations.multiColumn).flat()}},data:()=>({headers:[{text:"Constraint Name",value:"constraintName",width:"25%"},{text:"Table",value:"uqTableId",width:"20%"},{text:"Uq Column",value:"uqSource",width:"25%"},{text:"Index",value:"uqIndexEvaluation",width:"30%"}]})},Fi=ji,Li=Object(y["a"])(Fi,$i,Ai,!1,null,null,null),Gi=Li.exports;x()(Li,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var qi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",{staticClass:"ma-3 pa-3 blue darken-4",attrs:{dense:""}},[a("h2",[e._v("Check Constraints")]),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.mappedConstraints,"hide-default-footer":!0}})],1)],1)},Ui=[],Bi={name:"CheckConstraints",props:{checkConstraints:{type:Array,required:!0}},computed:{mappedConstraints(){return this.checkConstraints.map(e=>{return{...e,expanded:!1,tableName:e.tableConstraints[0].tableName}})}},methods:{changeSort(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},data:()=>({headers:[{text:"Name",sortable:!0,value:"constraintName"},{text:"Check Clause",sortable:!0,value:"checkClause"}],pagination:{sortBy:"constraintName",rowsPerPage:-1}})},zi=Bi,Mi=Object(y["a"])(zi,qi,Ui,!1,null,null,null),Hi=Mi.exports;x()(Mi,{VCard:Ce["a"],VContainer:k["a"],VDataTable:se["a"]});var Qi={name:"ConstraintsAndIndices",components:{GenericIndexSet:Pi,FkIndexConstraints:Vi,UqIndexSet:Gi,CheckConstraints:Hi,ScriptViewer:Rt["a"]},props:{tableSchema:{type:String,required:!1},tableName:{type:String,required:!1}},methods:{},computed:{allIndexEvaluations(){const e=Object.values(this.$store.state.genericIndexEvaluations),t=this.tableSchema?e.filter(e=>e.tableKey.split(".")[0]===this.tableSchema):e,a=this.tableName?e.filter(e=>e.tableKey.split(".")[0]===this.tableSchema&&e.tableKey.split(".")[1]===this.tableName):t;return a},fkIndexEvaluations(){const e=this.$store.state.fkIndexEvaluations,t=this.tableSchema?{singleColumn:Object.values(e.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema}),multiColumn:Object.values(e.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema})}:e,a=this.tableName?{singleColumn:Object.values(t.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName}),multiColumn:Object.values(t.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName})}:t;return a},uqIndexEvaluations(){const e=this.$store.state.uqIndexEvaluations,t=this.tableSchema?{singleColumn:Object.values(e.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema}),multiColumn:Object.values(e.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableSchema||t.tableSchema===this.tableSchema})}:e,a=this.tableName?{singleColumn:Object.values(t.singleColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName}),multiColumn:Object.values(t.multiColumn).filter(e=>{const t=e[0]||{};return!this.tableName||t.tableName===this.tableName})}:t;return a},hideCheckConstraints(){return null===this.tableName||void 0===this.tableName},checkConstraints(){return this.tableSchema&&this.tableName?this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema).schemaTables.find(e=>e.tableName===this.tableName).checkConstraints:[]},createIndicesScript(){const e=Object.values(this.$store.state.fkIndexEvaluations.singleColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema).map(e=>e[0]),t=Object.values(this.$store.state.fkIndexEvaluations.multiColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema),a=Object.values(this.$store.state.uqIndexEvaluations.singleColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema).map(e=>e[0]),i=Object.values(this.$store.state.uqIndexEvaluations.multiColumn).filter(e=>e.length>0).filter(e=>!this.tableName||this.tableName===e[0].tableName).filter(e=>!this.tableSchema||this.tableSchema===e[0].tableSchema),n=[...e,...t,...a,...i].flat(),l=(n.map(e=>e.idxKey),Object.values(this.$store.state.genericIndexEvaluations).filter(e=>1===e.idxColumns.length).filter(e=>0===n.filter(t=>t.id===e.id).length).filter(e=>!this.tableName||this.tableName===e.tableName).filter(e=>!this.tableSchema||this.tableSchema===e.tableSchema)),o=[...n,...l].flat().reduce((e,t)=>{const a=e.find(e=>e.idxKey===t.idxKey);if(a){const i=e.filter(e=>e.idxKey!==t.idxKey),n=a.indices.map(e=>e.id),l=t.indices.filter(e=>-1===n.indexOf(e.id));return[...i,{...a,indices:[...a.indices,...l]}]}return[...e,t]},[]);return o.reduce((e,t)=>{return t.desiredRealization.create?e.concat(`${t.desiredRealization.create}\n`):e},"")},dropIndicesScript(){return Object.values(this.$store.state.indicesToDrop).reduce((e,t)=>{return this.tableName&&this.tableName!==t.tableName?e:this.schemaName&&this.tableSchema!==t.tableSchema?e:e.concat(`---- DROP INDEX: ${t.indexName}\n${t.indexDrop}\n----------\n\n`)},"")}},data:()=>({activeTab:0})},Wi=Qi,Ki=Object(y["a"])(Wi,hi,bi,!1,null,null,null),Ji=Ki.exports;x()(Ki,{VCard:Ce["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Xi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"tableDefinition",attrs:{ripple:""}},[e._v("\n      Definition\n    ")]),a("v-tab-item",{key:"tableDefinition"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.tableDefinition,showReadability:!1}})],1)],1),a("v-tab",{key:"tableIndices",attrs:{ripple:""}},[e._v("\n      Indices\n    ")]),a("v-tab-item",{key:"tableIndices"},[a("v-card",{attrs:{flat:""}},[a("script-viewer",{attrs:{scriptText:e.tableIndicesRealization,showReadability:!1}})],1)],1),a("v-tab",{key:"tableSecurityPolicy",attrs:{ripple:""}},[e._v("\n      Security Policy Script\n    ")]),a("v-tab-item",{key:"tableSecurityPolicy"},[a("v-card",{attrs:{flat:""}},[a("table-policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.tableInfo}})],1)],1)],1)],1)},Yi=[],Zi=a("96b5"),en={name:"TableScripts",components:{ScriptViewer:Rt["a"],TablePolicyRealization:Zi["a"]},props:{tableInfo:{type:Object,required:!0}},computed:{tableDefinition(){return"TABLE DEFINITION NOT IMPLMENTED YET"},tableIndicesRealization(){const e=Object.values(this.$store.state.genericIndexEvaluations).filter(e=>e.tableKey===`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`),t=e.reduce((e,t)=>{return""!==t.desiredRealization.drop?[...e,t.desiredRealization.drop]:e},[]),a=e.reduce((e,t)=>{return""!==t.desiredRealization.create?[...e,t.desiredRealization.create]:e},[]),i=t.length>0?`-- INDICES TO DROP\n\n${t.join("")}`:"",n=a.length>0?`-- INDICES TO CREATE\n\n${a.join("")}`:"",l=i.concat("\n\n").concat(n);return l},policyDefinition(){const e=this.$store.state.tablePolicyAssignments[`${this.tableInfo.tableSchema}.${this.tableInfo.tableName}`].policyDefinitionId;return this.$store.state.policies.find(t=>t.id===e)}},methods:{},data:()=>({activeTab:null})},tn=en,an=Object(y["a"])(tn,Xi,Yi,!1,null,null,null),nn=an.exports;x()(an,{VCard:Ce["a"],VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var ln={name:"Table",components:{TableDetail:gt,TableColumns:Et,TableConstraints:$a,TableIndices:da,TableGrants:qa,TableColumnGrants:Qa,TablePolicies:Za,TableTriggers:mi,TablePolicyDefinition:pi["a"],ConstraintsAndIndices:Ji,TableScripts:nn},props:{id:{type:String,required:!0}},computed:{tableInfo(){const e=this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema),t=e.schemaTables.find(e=>e.tableName===this.tableName),a=this.$store.state.tablePolicyAssignments[this.id].policyDefinitionId;return{...t,policyDefinitionId:a}},tableName(){return this.id.split(".")[1]},tableSchema(){return this.id.split(".")[0]},tableColumns(){return this.tableInfo.tableColumns||[]},indices(){return this.tableInfo.indices||[]},tableGrants(){return this.tableInfo.roleTableGrants||[]},tableColumnGrants(){return this.tableInfo.roleColumnGrants||[]},tablePolicies(){return this.tableInfo.policies||[]},tableTriggers(){return this.tableInfo.triggers||[]}},methods:{},data:()=>({activeTab:null}),beforeRouteUpdate(e,t,a){a()}},on=ln,rn=Object(y["a"])(on,tt,at,!1,null,null,null),sn=rn.exports;x()(rn,{VCard:Ce["a"],VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var cn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"cols",attrs:{ripple:""}},[e._v("\n      Columns\n    ")]),a("v-tab-item",{key:"cols"},[a("v-card",{attrs:{flat:""}},[a("view-columns",{attrs:{viewInfo:e.tableInfo}})],1)],1)],1)],1)},un=[],dn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:""}},[a("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.tableDetail,"hide-default-footer":"","calculate-widths":"",dense:"","items-per-page":100}})],1)},mn=[],pn={name:"ViewColumns",props:{viewInfo:{type:Object,required:!0}},components:{},methods:{},computed:{tableDetail(){const e=this.viewInfo.tableColumns||[];return e}},data:()=>({headers:[{text:"Ordinal",sortable:!0,value:"ordinalPosition"},{text:"Column Name",sortable:!0,value:"columnName"},{text:"Data Type",sortable:!0,value:"dataType"}],pagination:{sortBy:"ordinalPosition",rowsPerPage:-1}})},hn=pn,bn=Object(y["a"])(hn,dn,mn,!1,null,null,null),fn=bn.exports;x()(bn,{VContainer:k["a"],VDataTable:se["a"]});var vn={name:"DbView",components:{ViewColumns:fn},props:{id:{type:String,required:!0}},computed:{tableInfo(){const e=this.$store.state.managedSchemata.find(e=>e.schemaName===this.tableSchema),t=e.schemaTables.find(e=>e.tableName===this.tableName);return{...t}},tableName(){return this.id.split(".")[1]},tableSchema(){return this.id.split(".")[0]},tableColumns(){return this.tableInfo.tableColumns||[]}},methods:{},data:()=>({activeTab:null}),beforeRouteUpdate(e,t,a){a()}},yn=vn,gn=Object(y["a"])(yn,cn,un,!1,null,null,null),xn=gn.exports;x()(gn,{VCard:Ce["a"],VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var kn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Role Manager")]),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"roles",attrs:{ripple:""}},[e._v("\n      Roles\n    ")]),a("v-tab-item",{key:"roles"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"roles"},[a("roles")],1)],1)],1)],1)],1),a("v-tab",{key:"script",attrs:{ripple:""}},[e._v("\n      Create Roles Script\n    ")]),a("v-tab-item",{key:"script"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"script"},[a("create-roles-realization")],1)],1)],1)],1)],1)],1)],1)},Nn=[],Cn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},_n=[],Tn=a("4eb5"),Sn=a.n(Tn);function En(e){const t=e.roleSet.dbOwnerRole;return`\n------------  DB OWNER ROLE ------------\nDO\n$body$\nBEGIN\n  IF NOT EXISTS (\n    SELECT    *\n    FROM   pg_catalog.pg_roles\n    WHERE  rolname = '${t.roleName}')\n  THEN\n    CREATE ROLE ${t.roleName};\n  END IF;\n\n  ALTER ROLE ${t.roleName} with LOGIN;\n  ALTER ROLE ${t.roleName} with CREATEDB;\n\nEND\n$body$;\n--||--\n---------- END DB OWNER ROLE -----------\n  `}function Pn(e){const t=e.roleSet.dbAuthenticatorRole,a=e.roleSet.dbUserRoles;return`\n------------  DB AUTHENTICATOR ROLE ------------\nDO\n$body$\nBEGIN\n  IF NOT EXISTS (\n    SELECT    *\n    FROM   pg_catalog.pg_roles\n    WHERE  rolname = '${t.roleName}')\n  THEN\n    CREATE ROLE ${t.roleName};\n  END IF;\n\nALTER ROLE ${t.roleName} with LOGIN;\nALTER ROLE ${t.roleName} with NOINHERIT;\n\n${a.map(e=>`GRANT ${e.roleName} TO ${t.roleName};`).join("\n")}\n\nEND\n$body$;\n--||--\n---------- END DB AUTHENTICATOR ROLE -----------\n  `}function Dn(e){const t=e.roleSet.dbUserRoles.sort((e,t)=>{return e.applicableRoles.length-t.applicableRoles.length});return`\n---------- DB USER ROLES -----------\n${t.map(e=>{return`\n    ------------ ${e.roleName}\n      DO\n      $body$\n      BEGIN\n        IF NOT EXISTS (\n          SELECT    *\n          FROM   pg_catalog.pg_roles\n          WHERE  rolname = '${e.roleName}'\n        ) THEN\n          CREATE ROLE ${e.roleName};\n        END IF;\n\n        ALTER ROLE ${e.roleName} with NOLOGIN;\n        ${e.applicableRoles.map(t=>{return`\n        GRANT ${t.roleName} TO ${e.roleName};`}).join("")}\n\n      END\n      $body$;\n      --||--\n    -------- END ${e.roleName}\n`}).join("\n")}\n---------- END USER ROLES ----------\n\n`}function In(e){return["\n----------\n----------  BEGIN POSTGRES ROLES SQL\n----------\n    ",En(e),Dn(e),Pn(e),"\n----------\n----------  END POSTGRES ROLES SQL\n----------\n--==\n"].join("\n")}var wn=In,Rn={name:"CreateRolesRealization",mixins:[Sn.a],components:{ScriptViewer:Rt["a"]},props:{},data(){return{policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},doComputePolicy(){this.computedPolicy=wn(this.$store.state)},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},On=Rn,Vn=Object(y["a"])(On,Cn,_n,!1,null,null,null),$n=Vn.exports;x()(Vn,{VContainer:k["a"]});var An={name:"RoleManagerView",components:{Roles:we,CreateRolesRealization:$n},props:{},computed:{},data:()=>({activeTab:0})},jn=An,Fn=Object(y["a"])(jn,kn,Nn,!1,null,null,null),Ln=Fn.exports;x()(Fn,{VCard:Ce["a"],VContainer:k["a"],VFlex:Te["a"],VLayout:Se["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Gn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("Security Management")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"table-security",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Table Security\n    ")]),a("v-tab-item",{key:"table-security"},[a("v-card",[a("table-security-view")],1)],1),a("v-tab",{key:"function-security",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Function Security\n    ")]),a("v-tab-item",{key:"function-security"},[a("v-card",[a("function-security-view")],1)],1),a("v-tab",{key:"scripts-summary",attrs:{ripple:"",disabled:e.initializing}},[e._v("\n      Scripts Summary\n    ")]),a("v-tab-item",{key:"scripts-summary"},[a("v-card",[a("security-scripts-summary-view")],1)],1),a("v-tab",{key:"help",attrs:{ripple:""}},[e._v("\n      Help\n    ")]),a("v-tab-item",{key:"help"},[a("v-container",{attrs:{fluid:""}},[a("h2",[a("a",{attrs:{href:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf",target:"_blank"}},[e._v("graphile.org rls infosheet")])]),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{attrs:{"align-self":"stretch",cols:"12"}},[a("pdf",{attrs:{src:"https://learn.graphile.org/docs/PostgreSQL_Row_Level_Security_Infosheet.pdf"}})],1)],1)],1)],1)],1)],1)},qn=[],Un=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),a("v-tab-item",{key:"policyAssignment"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"policyAssignment"},[a("policy-assignment")],1)],1)],1)],1)],1),a("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),a("v-tab-item",{key:"policies"},[a("v-card",[a("schema-security-scripts")],1)],1),a("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),a("v-tab-item",{key:"policy-manager"},[a("v-card",[a("policy-manager")],1)],1)],1)],1)},Bn=[],zn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"by-schema",attrs:{ripple:""}},[e._v("\n      By Schema\n    ")]),a("v-tab-item",{key:"by-schema"},[a("table-policy-assignment-by-schema")],1),a("v-tab",{key:"by-policy",attrs:{ripple:""}},[e._v("\n      By Policy\n    ")]),a("v-tab-item",{key:"by-policy"},[a("table-policy-assignment-by-policy")],1)],1)],1)},Mn=[],Hn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("policy-assignment-schema",{attrs:{schema:e}})],1)}))],2)],1)},Qn=[],Wn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,tables:e.selected,bulkAssign:!0,disabled:e.selected.length<1}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.tablesToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":"",expanded:e.expanded},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}),e.showCustomizeButton(i)?a("table-policy-customize-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}):e._e()]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.policyDefinition.id,table:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},Kn=[],Jn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),a("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),a("v-spacer")],1)],1)],1)],1)},Xn=[],Yn={name:"PolicyAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.currentSelection=this.currentPolicyDefinition},data(){return{dialog:!1,currentSelection:null}},computed:{displayValue(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},updateDisabled(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition(){this.dialog=!1;const e=this.tables.reduce((e,t)=>{return e.concat([t.id])},[]);this.$store.commit("assignTablePolicy",{tableIds:e,policyDefinitionId:this.currentSelection.id}),this.$emit("policyAssigned",this.tables)}}},Zn=Yn,el=(a("35d9"),a("2b5d")),tl=Object(y["a"])(Zn,Jn,Xn,!1,null,null,null),al=tl.exports;x()(tl,{VBtn:q["a"],VCard:Ce["a"],VCardActions:_e["a"],VCardTitle:_e["c"],VCombobox:el["a"],VDialog:Ae["a"],VSpacer:Q["a"]});var il=a("bd5a"),nl={name:"PolicyAssignment",components:{PolicyDefinition:pi["a"],PolicyAssignmentDialog:al,TablePolicyCustomizeDialog:il["a"]},props:{schema:{type:Object,required:!0}},methods:{showCustomizeButton(e){return!!e&&(!e.policyDefinition||!e.policyDefinition.customIdentifier)},expandItems(e){this.expanded=e}},watch:{},computed:{tablesToShow(){return this.schema.schemaTables.filter(e=>"BASE TABLE"===e.tableType).map(e=>{const t=this.$store.state.tablePolicyAssignments[e.id].policyDefinitionId,a=this.policies.find(e=>e.id===t)||this.defaultPolicy;return{...e,policyDefinition:a,policyDefinitionId:a.id}})},defaultPolicy(){return this.$store.state.defaultPolicy},policies(){return this.$store.state.policies}},data:()=>({loading:!1,selected:[],expanded:[],headers:[{text:"",sortable:!1},{text:"Table Name",sortable:!1,value:"name"},{text:"Assigned Policy",sortable:!1,value:"assignedPolicy"}]})},ll=nl,ol=(a("cb8a"),Object(y["a"])(ll,Wn,Kn,!1,null,null,null)),rl=ol.exports;x()(ol,{VDataTable:se["a"],VToolbar:ye["a"]});var sl={name:"PolicyAssignment",components:{PolicyAssignmentSchema:rl},methods:{},watch:{},computed:{policies(){return this.$store.state.policies},managedSchemata(){return this.$store.state.managedSchemata.filter(e=>e.schemaTables.length>0).map(e=>{return{...e,schemaTables:e.schemaTables.map(e=>{const t=this.policies.find(t=>t.id===e.policyDefinitionId);return{...e,policyDefinition:t}}).sort((e,t)=>{return e.name<t.name?-1:1})}}).sort((e,t)=>{return e.schemaName<t.schemaName?-1:1})}},data:()=>({mappedSchemata:[]})},cl=sl,ul=Object(y["a"])(cl,Hn,Qn,!1,null,null,null),dl=ul.exports;x()(ul,{VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var ml=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-expansion-panels",{attrs:{dark:"","slider-color":"yellow"}},e._l(e.mappedPolicies,(function(t){return a("v-expansion-panel",{key:t.id,attrs:{ripple:""}},[a("v-expansion-panel-header",[e._v("\n      ("+e._s(t.numberOfAssignments)+") - "+e._s(t.name)+"\n    ")]),t.numberOfAssignments>0?a("v-expansion-panel-content",[a("table-policy-assignment-policy",{attrs:{policyDefinitionId:t.id}})],1):a("v-expansion-panel-content",[a("h2",[e._v("No assignments for this policy")])])],1)})),1)],1)},pl=[],hl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,tables:e.selected,bulkAssign:!0,disabled:e.selected.length<1}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.tablesToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":"",expanded:e.expanded},on:{"update:expanded":function(t){e.expanded=t}},scopedSlots:e._u([{key:"item.schemaName",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableSchema)+"\n      ")]}},{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.tableName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}),e.showCustomizeButton(i)?a("table-policy-customize-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,tables:[i]},on:{policyAssigned:e.expandItems}}):e._e()]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.policyDefinition.id,table:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},bl=[],fl={name:"PolicyAssignment",components:{PolicyDefinition:pi["a"],PolicyAssignmentDialog:al,TablePolicyCustomizeDialog:il["a"]},props:{policyDefinitionId:{type:Number,required:!0}},methods:{showCustomizeButton(e){return!!e&&(!e.policyDefinition||!e.policyDefinition.customIdentifier)},expandItems(e){this.expanded=e}},watch:{},computed:{tablesToShow(){const e=Object.keys(this.$store.state.tablePolicyAssignments).filter(e=>{return this.$store.state.tablePolicyAssignments[e].policyDefinitionId===this.policyDefinitionId});return this.managedSchemata.reduce((t,a)=>{const i=a.schemaTables.filter(t=>-1!==e.indexOf(t.id));return[...t,...i]},[]).map(e=>{return console.log("t",e),{...e,policyDefinition:this.policyDefinition,policyDefinitionId:this.policyDefinition.id}})},policyDefinition(){return this.policies.find(e=>e.id===this.policyDefinitionId)||this.defaultPolicy},managedSchemata(){return this.$store.state.managedSchemata},defaultPolicy(){return this.$store.state.defaultPolicy},policies(){return this.$store.state.policies}},data:()=>({loading:!1,selected:[],expanded:[],headers:[{text:"",sortable:!1},{text:"Schema Name",sortable:!1,value:"tableSchema"},{text:"Table Name",sortable:!1,value:"name"},{text:"Assigned Policy",sortable:!1,value:"assignedPolicy"}]})},vl=fl,yl=(a("9969"),Object(y["a"])(vl,hl,bl,!1,null,null,null)),gl=yl.exports;x()(yl,{VDataTable:se["a"],VToolbar:ye["a"]});var xl={name:"TablePolicyAssignmentByPolicy",components:{TablePolicyAssignmentPolicy:gl},methods:{},watch:{},computed:{mappedPolicies(){return this.policies.map(e=>{const t=Object.keys(this.tablePolicyAssignments).reduce((t,a)=>{return this.tablePolicyAssignments[a].policyDefinitionId===e.id?t+1:t},0);return{...e,numberOfAssignments:t}})},policies(){return this.$store.state.policies},tablePolicyAssignments(){return this.$store.state.tablePolicyAssignments}},data:()=>({mappedSchemata:[]})},kl=xl,Nl=a("cd55"),Cl=a("49e2"),_l=a("c865"),Tl=a("0393"),Sl=Object(y["a"])(kl,ml,pl,!1,null,null,null),El=Sl.exports;x()(Sl,{VContainer:k["a"],VExpansionPanel:Nl["a"],VExpansionPanelContent:Cl["a"],VExpansionPanelHeader:_l["a"],VExpansionPanels:Tl["a"]});var Pl={name:"TablePolicyAssignment",components:{TablePolicyAssignmentBySchema:dl,TablePolicyAssignmentByPolicy:El},methods:{},watch:{},computed:{},data:()=>({})},Dl=Pl,Il=Object(y["a"])(Dl,zn,Mn,!1,null,null,null),wl=Il.exports;x()(Il,{VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Rl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,(function(t){return a("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._l(e.allPolicies,(function(t){return a("v-tab-item",{key:t.name},[a("script-viewer",{attrs:{scriptText:t.policy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)}))],2)],1)},Ol=[],Vl=a("2f62"),$l=a("c92d");function Al(e,t,a){return a.sort((e,t)=>{return e.tablename<t.tablename?-1:1}).reduce((a,i)=>{const n=e.policies.find(t=>t.id===e.tablePolicyAssignments[i.id].policyDefinitionId),l={schemaName:i.tableSchema,tableName:i.tablename},o=Object($l["a"])(n,t,l,i);return a.concat(o)},"")}var jl=Al;function Fl(e,t){return e.managedSchemata.filter(e=>!e.parked).filter(e=>e.schemaTables.length>0).reduce((a,i)=>{const n=i.schemaTables.filter(e=>"BASE TABLE"===e.tableType),l={name:`${i.schemaName}`,policy:jl(e,t,n)};return a.concat([l])},[]).sort((e,t)=>{return e.name<t.name?-1:1})}var Ll=Fl;function Gl(e,t){const a="All Schemata - Tables",i=Ll(e,t),n=i.reduce((e,t)=>{return e.concat(t.policy)},"");return{name:a,policy:n}}var ql=Gl,Ul={name:"SchemaSecurityScripts",mixins:[],components:{ScriptViewer:Rt["a"]},props:{},computed:{...Object(Vl["b"])(["policies","managedSchemata"])},watch:{policyReadability(){this.computeAllPolicies()}},methods:{computeAllPolicies(){const e=Ll(this.$store.state,this.policyReadability),t=ql(this.$store.state,this.policyReadability);this.allPolicies=[...e,t]},policyReadabilityChanged(e){this.policyReadability=e},handleCopyStatus(e){alert(e)},refresh(e){this.computeAllPolicies()},expand(e){e.policy=`${e.policy} `},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computeAllPolicies()}},Bl=Ul,zl=Object(y["a"])(Bl,Rl,Ol,!1,null,null,null),Ml=zl.exports;x()(zl,{VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Hl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{color:"primary",dark:""}},i),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),a("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),a("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},Ql=[],Wl=a("a985"),Kl=Wl["a"],Jl=a("8654"),Xl=Object(y["a"])(Kl,Hl,Ql,!1,null,null,null),Yl=Xl.exports;x()(Xl,{VBtn:q["a"],VCard:Ce["a"],VCardActions:_e["a"],VCardTitle:_e["c"],VDataTable:se["a"],VDialog:Ae["a"],VSpacer:Q["a"],VTextField:Jl["a"],VToolbar:ye["a"]});var Zl={name:"TableSecurityView",components:{SchemaSecurityScripts:Ml,PolicyManager:Yl,PolicyAssignment:wl},props:{},computed:{},data:()=>({activeTab:0})},eo=Zl,to=Object(y["a"])(eo,Un,Bn,!1,null,null,null),ao=to.exports;x()(to,{VCard:Ce["a"],VContainer:k["a"],VFlex:Te["a"],VLayout:Se["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var io=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"policyAssignment",attrs:{ripple:""}},[e._v("\n      Policy Assignment\n    ")]),a("v-tab-item",{key:"policyAssignment"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"policyAssignment"},[a("policy-assignment")],1)],1)],1)],1)],1),a("v-tab",{key:"policies",attrs:{ripple:""}},[e._v("\n      Schema Security Scripts\n    ")]),a("v-tab-item",{key:"policies"},[a("v-card",[a("schema-security-scripts")],1)],1),a("v-tab",{key:"policy-manager",attrs:{ripple:""}},[e._v("\n      Policy Templates\n    ")]),a("v-tab-item",{key:"policy-manager"},[a("v-card",[a("policy-manager")],1)],1)],1)],1)},no=[],lo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{color:"primary",dark:""}},i),[e._v("New Policy Template")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("New Policy")]),a("v-text-field",{attrs:{label:"Name"},model:{value:e.newPolicyName,callback:function(t){e.newPolicyName=t},expression:"newPolicyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.saveNewPolicy}},[e._v("Save")]),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")])],1)],1)],1)],1),a("v-data-table",{attrs:{headers:e.headers,items:e.policies,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("policy-definition",{key:t.item.id,attrs:{policyId:t.item.id}})],1)]}}])})],1)},oo=[],ro=a("03f5"),so=ro["a"],co=Object(y["a"])(so,lo,oo,!1,null,null,null),uo=co.exports;x()(co,{VBtn:q["a"],VCard:Ce["a"],VCardActions:_e["a"],VCardTitle:_e["c"],VDataTable:se["a"],VDialog:Ae["a"],VSpacer:Q["a"],VTextField:Jl["a"],VToolbar:ye["a"]});var mo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[a("v-tab",{key:"by-schema",attrs:{ripple:""}},[e._v("\n      By Schema\n    ")]),a("v-tab-item",{key:"by-schema"},[a("function-policy-assignment-by-schema")],1),a("v-tab",{key:"by-policy",attrs:{ripple:""}},[e._v("\n      By Policy\n    ")]),a("v-tab-item",{key:"by-policy"},[a("function-policy-assignment-by-policy")],1)],1)],1)},po=[],ho=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n      "+e._s(t.schemaName)+"\n    ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("function-policy-assignment-schema",{attrs:{schema:e}})],1)}))],2)],1)},bo=[],fo=a("82cd"),vo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Assign Policy")]),a("v-combobox",{attrs:{items:e.allPolicyDefinitions,"item-text":"name","item-value":"id"},model:{value:e.currentSelection,callback:function(t){e.currentSelection=t},expression:"currentSelection"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.updateDisabled},on:{click:e.updateTablePolicyDefinition}},[e._v("Update")]),a("v-spacer")],1)],1)],1)],1)},yo=[],go={name:"FunctionAssignmentDialog",props:{currentPolicyDefinition:{type:Object,required:!0},functions:{type:Array,required:!0},bulkAssign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.currentSelection=this.currentPolicyDefinition},data(){return{dialog:!1,expanded:[],currentSelection:null}},computed:{displayValue(){return this.bulkAssign?"Bulk Assign":this.currentPolicyDefinition?this.currentPolicyDefinition.name:"n/a"},allPolicyDefinitions(){return this.$store.state.functionPolicies},updateDisabled(){return!this.bulkAssign&&(!this.currentPolicyDefinition||!this.currentSelection||this.currentPolicyDefinition.id===this.currentSelection.id)}},watch:{},methods:{updateTablePolicyDefinition(){this.dialog=!1;const e=this.functions.reduce((e,t)=>{return e.concat([t.id])},[]);this.$store.commit("assignFunctionPolicy",{functionIds:e,policyDefinitionId:this.currentSelection.id}),this.$emit("policyAssigned",this.functions)}}},xo=go,ko=(a("a789"),Object(y["a"])(xo,vo,yo,!1,null,null,null)),No=ko.exports;x()(ko,{VBtn:q["a"],VCard:Ce["a"],VCardActions:_e["a"],VCardTitle:_e["c"],VCombobox:el["a"],VDialog:Ae["a"],VSpacer:Q["a"]});var Co=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,functions:e.selected,bulkAssign:!0,disabled:0===e.selected.length}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.functionsToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.functionName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,functions:[i]},on:{policyAssigned:e.expandItems}})]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{attrs:{policyId:t.item.policyDefinition.id,aFunction:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},_o=[],To={name:"FunctionAssignment",components:{PolicyDefinition:fo["a"],PolicyAssignmentDialog:No},props:{schema:{type:Object,required:!0}},methods:{expandItems(e){this.expanded=e}},watch:{},computed:{functionsToShow(){return this.schema.schemaFunctions.map(e=>{const t=this.$store.state.functionPolicyAssignments[e.id].policyDefinitionId,a=this.$store.state.functionPolicies.find(e=>e.id===t);return{...e,policyDefinition:a,policyDefinitionId:t}})},selectAllValue(){return this.schema.schemaFunctions.length===this.selected.length},defaultPolicy(){return this.$store.state.defaultFunctionPolicy}},data:()=>({selected:[],headers:[{text:"",sortable:!1},{text:"",sortable:!1},{text:"Function Name",sortable:!1,value:"functionName"},{text:"Policy Name",sortable:!1,value:"assignedPolicy"}]})},So=To,Eo=Object(y["a"])(So,Co,_o,!1,null,null,null),Po=Eo.exports;x()(Eo,{VDataTable:se["a"],VToolbar:ye["a"]});var Do={name:"FunctionPolicyAssignmentBySchema",components:{PolicyDefinition:fo["a"],PolicyAssignmentDialog:No,FunctionPolicyAssignmentSchema:Po},methods:{},watch:{},computed:{functionPolicies(){return this.$store.state.functionPolicies},managedSchemata(){return this.$store.state.managedSchemata.filter(e=>e.schemaFunctions.length>0).map(e=>{return{...e,schemaFunctions:e.schemaFunctions.map(e=>{const t=this.functionPolicies.find(t=>t.id===e.functionPolicyDefinitionId);return{...e,policyDefinition:t}}).sort((e,t)=>{return e.functionname<t.functionname?-1:1})}}).sort((e,t)=>{return e.schemaName<t.schemaName?-1:1})}},data:()=>({mappedSchemata:[],headers:[{text:"",sortable:!1},{text:"Function Name",sortable:!1},{text:"Policy Name",sortable:!1}]})},Io=Do,wo=Object(y["a"])(Io,ho,bo,!1,null,null,null),Ro=wo.exports;x()(wo,{VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Oo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-expansion-panels",{attrs:{dark:"","slider-color":"yellow"}},e._l(e.mappedPolicies,(function(t){return a("v-expansion-panel",{key:t.id,attrs:{ripple:""}},[a("v-expansion-panel-header",[e._v("\n      ("+e._s(t.numberOfAssignments)+") - "+e._s(t.name)+"\n    ")]),t.numberOfAssignments>0?a("v-expansion-panel-content",[a("function-policy-assignment-policy",{attrs:{policyDefinitionId:t.id}})],1):a("v-expansion-panel-content",[a("h2",[e._v("No assignments for this policy")])])],1)})),1)],1)},Vo=[],$o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:e.defaultPolicy,functions:e.selected,bulkAssign:!0,disabled:0===e.selected.length}})],1),a("v-data-table",{attrs:{headers:e.headers,items:e.functionsToShow,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-select":"","show-expand":""},scopedSlots:e._u([{key:"item.name",fn:function(t){var a=t.item;return[e._v("\n        "+e._s(a.functionName)+"\n      ")]}},{key:"item.assignedPolicy",fn:function(t){var i=t.item;return[a("policy-assignment-dialog",{attrs:{currentPolicyDefinition:i.policyDefinition,functions:[i]},on:{policyAssigned:e.expandItems}})]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+2}},[a("policy-definition",{attrs:{policyId:t.item.policyDefinition.id,aFunction:t.item}})],1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)},Ao=[],jo={name:"FunctionPolicyAssignmentPolicy",components:{PolicyDefinition:fo["a"],PolicyAssignmentDialog:No},props:{policyDefinitionId:{type:Number,required:!0}},methods:{expandItems(e){this.expanded=e}},watch:{},computed:{functionsToShow(){const e=Object.keys(this.$store.state.functionPolicyAssignments).filter(e=>{return this.$store.state.functionPolicyAssignments[e].policyDefinitionId===this.policyDefinitionId});return this.managedSchemata.reduce((t,a)=>{const i=a.schemaFunctions.filter(t=>-1!==e.indexOf(t.id));return[...t,...i]},[]).map(e=>{return{...e,policyDefinition:this.policyDefinition,policyDefinitionId:this.policyDefinition.id}})},policyDefinition(){return this.policies.find(e=>e.id===this.policyDefinitionId)||this.defaultPolicy},managedSchemata(){return this.$store.state.managedSchemata},defaultPolicy(){return this.$store.state.defaultFunctionPolicy},policies(){return this.$store.state.policies}},data:()=>({selected:[],headers:[{text:"",sortable:!1},{text:"",sortable:!1},{text:"Schema Name",sortable:!1,value:"tableSchema"},{text:"Function Name",sortable:!1,value:"functionName"},{text:"Policy Name",sortable:!1,value:"assignedPolicy"}]})},Fo=jo,Lo=Object(y["a"])(Fo,$o,Ao,!1,null,null,null),Go=Lo.exports;x()(Lo,{VDataTable:se["a"],VToolbar:ye["a"]});var qo={name:"FunctionPolicyAssignmentByPolicy",components:{FunctionPolicyAssignmentPolicy:Go},methods:{},watch:{},computed:{mappedPolicies(){return this.policies.map(e=>{const t=Object.keys(this.functionPolicyAssignments).reduce((t,a)=>{return this.functionPolicyAssignments[a].policyDefinitionId===e.id?t+1:t},0);return{...e,numberOfAssignments:t}})},policies(){return this.$store.state.functionPolicies},functionPolicyAssignments(){return this.$store.state.functionPolicyAssignments}},data:()=>({mappedSchemata:[]})},Uo=qo,Bo=Object(y["a"])(Uo,Oo,Vo,!1,null,null,null),zo=Bo.exports;x()(Bo,{VContainer:k["a"],VExpansionPanel:Nl["a"],VExpansionPanelContent:Cl["a"],VExpansionPanelHeader:_l["a"],VExpansionPanels:Tl["a"]});var Mo={name:"FunctionPolicyAssignment",components:{FunctionPolicyAssignmentBySchema:Ro,FunctionPolicyAssignmentByPolicy:zo},methods:{},watch:{},computed:{},data:()=>({})},Ho=Mo,Qo=Object(y["a"])(Ho,mo,po,!1,null,null,null),Wo=Qo.exports;x()(Qo,{VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Ko=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.allPolicies,(function(t){return a("v-tab",{key:t.name,attrs:{ripple:""}},[e._v("\n      "+e._s(t.name)+"\n    ")])})),e._l(e.allPolicies,(function(t){return a("v-tab-item",{key:t.name},[a("script-viewer",{attrs:{scriptText:t.policy,skipFormat:"",canExecute:""},on:{"readability-changed":e.readabilityChanged}})],1)}))],2)],1)},Jo=[],Xo=a("0100");function Yo(e,t,a){const i=a.sort((e,t)=>{return e.functionname<t.functionname?-1:1}).reduce((a,i)=>{const n=e.functionPolicies.find(t=>t.id===e.functionPolicyAssignments[i.id].policyDefinitionId),l={},o=Object(Xo["a"])(n,t,l,i);return a.concat(o)},"");return i}var Zo=Yo;function er(e,t){return e.managedSchemata.filter(e=>!e.parked).filter(e=>e.schemaFunctions.length>0).reduce((a,i)=>{const n=i.schemaFunctions,l={name:`${i.schemaName}`,policy:Zo(e,t,n)};return a.concat([l])},[]).sort((e,t)=>{return e.name<t.name?-1:1})}var tr=er;function ar(e,t){const a="All Schemata - Functions",i=tr(e,t),n=i.reduce((e,t)=>{return e.concat(t.policy)},"");return{name:a,policy:n}}var ir=ar,nr={name:"SchemaSecurityScripts",mixins:[],components:{ScriptViewer:Rt["a"]},props:{},computed:{...Object(Vl["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.computeAllPolicies()},policyReadability(){this.computeAllPolicies()}},methods:{computeAllPolicies(){const e=tr(this.$store.state,this.policyReadability),t=ir(this.$store.state,this.policyReadability);this.allPolicies=[...e,t]},readabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({allPolicies:[],schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computeAllPolicies()}},lr=nr,or=Object(y["a"])(lr,Ko,Jo,!1,null,null,null),rr=or.exports;x()(or,{VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var sr={name:"FunctionSecurityView",components:{SchemaSecurityScripts:rr,PolicyManager:uo,PolicyAssignment:Wo},props:{},computed:{},data:()=>({activeTab:null})},cr=sr,ur=Object(y["a"])(cr,io,no,!1,null,null,null),dr=ur.exports;x()(ur,{VCard:Ce["a"],VContainer:k["a"],VFlex:Te["a"],VLayout:Se["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var mr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"script",attrs:{ripple:""}},[e._v("\n      Create Roles Script\n    ")]),a("v-tab-item",{key:"script"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"script"},[a("create-roles-realization")],1)],1)],1)],1)],1),a("v-tab",{key:"ownership-policy",attrs:{ripple:""}},[e._v("\n      Ownership Policy\n    ")]),a("v-tab-item",{key:"ownership-policy"},[a("v-card",[a("ownership-policy-realization")],1)],1),a("v-tab",{key:"schema-usage",attrs:{ripple:""}},[e._v("\n      Schema Usage Script\n    ")]),a("v-tab-item",{key:"schema-usage"},[a("v-card",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-card",{key:"schema-usage"},[a("schema-usage-realization")],1)],1)],1)],1)],1),a("v-tab",{key:"table-security",attrs:{ripple:""}},[e._v("\n      Table Security\n    ")]),a("v-tab-item",{key:"table-security"},[a("v-card",[a("table-security-scripts")],1)],1),a("v-tab",{key:"function-security",attrs:{ripple:""}},[e._v("\n      Function Security\n    ")]),a("v-tab-item",{key:"function-security"},[a("v-card",[a("function-security-scripts")],1)],1),a("v-tab",{key:"master-security-policy",staticClass:"purple black--text",attrs:{ripple:"","active-class":"yellow red--text"}},[e._v("\n      Complete Security Policy\n    ")]),a("v-tab-item",{key:"master-security-policy"},[a("v-card",[a("master-security-policy-realization")],1)],1)],1)],1)},pr=[],hr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},br=[],fr=a("9dbb"),vr=a.n(fr);const yr="\n----------\n----------  BEGIN SCHEMA USAGE SQL\n----------\n\nREVOKE USAGE ON SCHEMA public FROM PUBLIC;\n\nGRANT USAGE ON SCHEMA public TO {{appAuthenticator}};\n\n{{#schemata}}\n------- {{schemaName}}\n  REVOKE USAGE ON SCHEMA {{schemaName}} FROM PUBLIC;\n  {{#rolesToRevoke}}\n  REVOKE USAGE ON SCHEMA {{schemaName}} FROM {{roleName}};\n  {{/rolesToRevoke}}\n\n  {{#rolesToGrant}}\n  GRANT USAGE ON SCHEMA {{schemaName}} TO {{.}};\n  {{/rolesToGrant}}\n{{/schemata}}\n----------\n----------  END SCHEMA USAGE SQL\n----------\n--==\n";function gr(...e){let t=[];e.forEach(e=>{t=[...t,...e]});const a=t.reduce((e,t)=>{return e.includes(t)?e:[...e,t]},[]);return a}const xr=e=>{const t=e.managedSchemata.sort((e,t)=>{return e.schemaName<t.schemaName?-1:e.schemaName>t.schemaName?1:0}).map(t=>{const a=Object.keys(e.tablePolicyAssignments).filter(e=>e.split(".")[0]===t.schemaName).reduce((t,a)=>{const i=e.tablePolicyAssignments[a],n=e.policies.find(e=>e.id===i.policyDefinitionId),l=Object.keys(n.roleGrants).filter(e=>{return Object.values(n.roleGrants[e]).indexOf("ALLOWED")>-1});return l.length>0?gr(t,l):t},[]),i=Object.keys(e.functionPolicyAssignments).filter(e=>e.split(".")[0]===t.schemaName).reduce((t,a)=>{const i=e.functionPolicyAssignments[a],n=e.functionPolicies.find(e=>e.id===i.policyDefinitionId),l=Object.keys(n.roleFunctionGrants).filter(e=>{return Object.values(n.roleFunctionGrants[e]).indexOf("ALLOWED")>-1});return l.length>0?gr(t,l):t},[]),n=[e.roleSet.dbAuthenticatorRole,...e.roleSet.dbUserRoles],l=gr(a,i).join(", ");return{...t,appAuthenticator:e.roleSet.dbAuthenticatorRole.roleName,rolesToRevoke:n,rolesToGrant:l}});return vr.a.render(yr,{schemata:t,appAuthenticator:e.roleSet.dbAuthenticatorRole.roleName})};var kr=xr,Nr={name:"SchemaUsageRealization",mixins:[Sn.a],components:{ScriptViewer:Rt["a"]},props:{},data(){return{policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},doComputePolicy(){this.computedPolicy=kr(this.$store.state)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},Cr=Nr,_r=Object(y["a"])(Cr,hr,br,!1,null,null,null),Tr=_r.exports;x()(_r,{VContainer:k["a"]});var Sr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.masterPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.readabilityChanged}})],1)},Er=[];const Pr="\n----------\n----------  BEGIN OWNERSHIP SQL\n----------\n\n{{#schemata}}\n----------  SCHEMA: {{schemaName}}\n  ALTER SCHEMA {{schemaName}} OWNER TO {{dbOwnerRole}};\n  -- tables\n  {{#schemaTables}}\n    ALTER TABLE {{schemaName}}.{{tableName}} OWNER TO {{dbOwnerRole}};\n  {{/schemaTables}}\n  -- functions\n  {{#schemaFunctions}}\n    ALTER FUNCTION {{schemaName}}.{{functionName}}({{argumentDataTypes}}) OWNER TO {{dbOwnerRole}};\n  {{/schemaFunctions}}\n----------  END SCHEMA: {{schemaName}}\n{{/schemata}}\n----------\n----------  END OWNERSHIP SQL\n----------\n--==\n",Dr=e=>{const t=e.managedSchemata.sort((e,t)=>{return e.schemaName<t.schemaName?-1:e.schemaName>t.schemaName?1:0}).map(e=>{return{...e,schemaFunctions:e.schemaFunctions.map(e=>{const t=e.argumentDataTypes.split(",").map(e=>e.replace("timestamp with time zone","timestamptz")).map(e=>e.trim().split(" ")[1]).join(", ");return{...e,argumentDataTypes:t}})}});return vr.a.render(Pr,{schemata:t,dbOwnerRole:e.roleSet.dbOwnerRole.roleName}).split("&#39;").join("'")};var Ir=Dr;function wr(e,t){return["--=====  BEGIN COMPLETE SECURITY POLICY -========",wn(e),"\n\n--*****  BEGIN OWNERSHIP -********",Ir(e,t),"--*****  END OWNERSHIP -**********","\n\n--*****  BEGIN SCHEMA USAGE -********",kr(e,t),"--*****  END SCHEMA USAGE -**********","\n\n--*****  BEGIN TABLE POLICIES -********",ql(e,t).policy,"--*****  END TABLE POLICIES -**********","\n\n--*****  BEGIN FUNCTION POLICIES -********",ir(e,t).policy,"--*****  END FUNCTION POLICIES -**********","\n\n--=====  END COMPLETE SECURITY POLICY -=========="].join("\n")}var Rr=wr,Or={name:"MasterSecurityPolicyRealization",mixins:[],components:{ScriptViewer:Rt["a"]},props:{},computed:{...Object(Vl["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.computePolicy()},policyReadability(){this.computePolicy()}},methods:{computePolicy(){this.masterPolicy=Rr(this.$store.state,this.policyReadability)},readabilityChanged(e){this.policyReadability=e},refresh(){this.computePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},data:()=>({masterPolicy:"N/A",schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computePolicy()}},Vr=Or,$r=Object(y["a"])(Vr,Sr,Er,!1,null,null,null),Ar=$r.exports;x()($r,{VContainer:k["a"]});var jr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computeOwnershipPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.readabilityChanged}})],1)},Fr=[],Lr={name:"OwnershipPolicyRealization",mixins:[],components:{ScriptViewer:Rt["a"]},props:{},computed:{...Object(Vl["b"])(["functionPolicies","managedSchemata"])},watch:{functionPolicies(){this.computePolicy()},policyReadability(){this.computePolicy()}},methods:{computePolicy(){this.computeOwnershipPolicy=Ir(this.$store.state,this.policyReadability)},readabilityChanged(e){this.policyReadability=e},refresh(){this.computePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},policyText(e){return e.policy},onCopy:function(){alert("Copied!")},onError:function(e){alert("Failed to copy scripts to clipboard"),console.error(e)}},data:()=>({computeOwnershipPolicy:"N/A",schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",policyReadability:"terse"}),mounted(){this.computePolicy()}},Gr=Lr,qr=Object(y["a"])(Gr,jr,Fr,!1,null,null,null),Ur=qr.exports;x()(qr,{VContainer:k["a"]});var Br={name:"SecurityScriptsSummaryView",components:{CreateRolesRealization:$n,SchemaUsageRealization:Tr,TableSecurityScripts:Ml,FunctionSecurityScripts:rr,MasterSecurityPolicyRealization:Ar,OwnershipPolicyRealization:Ur},props:{},computed:{},data:()=>({activeTab:0})},zr=Br,Mr=Object(y["a"])(zr,mr,pr,!1,null,null,null),Hr=Mr.exports;x()(Mr,{VCard:Ce["a"],VContainer:k["a"],VFlex:Te["a"],VLayout:Se["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Qr=a("858e"),Wr={name:"SecurityView",components:{FunctionSecurityView:dr,TableSecurityView:ao,SecurityScriptsSummaryView:Hr,pdf:Qr["a"]},props:{},computed:{initializing(){return this.$store.state.initializing||0===this.$store.state.roleSet.dbUserRoles.length}},data:()=>({activeTab:0}),watch:{},methods:{},mounted(){this.activeTab=this.$store.state.roleSet.dbUserRoles.length>0?0:2}},Kr=Wr,Jr=Object(y["a"])(Kr,Gn,qn,!1,null,null,null),Xr=Jr.exports;x()(Jr,{VCard:Ce["a"],VCol:dt["a"],VContainer:k["a"],VRow:mt["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Yr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h1",[e._v("PG LINT")])])},Zr=[],es={name:"PgLintView",components:{},props:{},computed:{},watch:{},data:()=>({}),methods:{}},ts=es,as=Object(y["a"])(ts,Yr,Zr,!1,null,null,null),is=as.exports;x()(as,{VContainer:k["a"]});var ns=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("function-search")],1)},ls=[],os=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("h2",[e._v("Search Terms")]),a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"search term",placeholder:"enter a search term"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1),a("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[a("h3",[e._v("OR")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"search term",placeholder:"enter a search term"},model:{value:e.searchTerm1,callback:function(t){e.searchTerm1=t},expression:"searchTerm1"}})],1),a("v-col",{staticClass:"text-center",attrs:{cols:"1"}},[a("h3",[e._v("OR")])]),a("v-col",{attrs:{cols:"3"}},[a("v-text-field",{attrs:{label:"search term",placeholder:"enter a search term"},model:{value:e.searchTerm2,callback:function(t){e.searchTerm2=t},expression:"searchTerm2"}})],1)],1),a("hr"),a("function-list",{attrs:{functions:e.functions}})],1)},rs=[],ss=(a("ab3b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{headers:e.headers,items:e.functions,"item-key":"id",dense:"","disable-pagination":"","disable-sort":"","hide-default-footer":"","show-expand":""},scopedSlots:e._u([{key:"item.blankLink",fn:function(t){var i=t.item;return[a("router-link",{attrs:{to:{name:"function",params:{id:i.id}},target:"_blank"}},[a("v-icon",[e._v("launch")])],1)]}},{key:"expanded-item",fn:function(t){return[a("td",{attrs:{colspan:e.headers.length+1}},[a("function",{attrs:{id:t.item.id}})],1)]}}])})}),cs=[],us={name:"FunctionList",components:{Function:ni["a"]},props:{functions:{type:Array,required:!0}},computed:{},data:()=>({headers:[{text:"",sortable:!1},{text:"schema",sortable:!1,value:"functionSchema"},{text:"function",sortable:!1,value:"functionName"},{text:"",sortable:!1,value:"blankLink"}]}),methods:{}},ds=us,ms=Object(y["a"])(ds,ss,cs,!1,null,null,null),ps=ms.exports;x()(ms,{VDataTable:se["a"],VIcon:M["a"]});var hs={name:"FunctionSearch",components:{FunctionList:ps},props:{},computed:{disabled(){return void 0===this.searchTerm||null===this.searchTerm||""===this.searchTerm},allFunctions(){return this.$store.state.managedSchemata.reduce((e,t)=>{return[...e,...t.schemaFunctions]},[])},functions(){return this.allFunctions.filter(e=>{const t=e.functionSchema.toLowerCase(),a=e.functionName.toLowerCase(),i=e.definition.toLowerCase(),n=-1!==t.indexOf(this.searchTerm.toLowerCase())||-1!==a.indexOf(this.searchTerm.toLowerCase())||-1!==i.indexOf(this.searchTerm.toLowerCase()),l=-1!==t.indexOf(this.searchTerm1.toLowerCase())||-1!==a.indexOf(this.searchTerm1.toLowerCase())||-1!==i.indexOf(this.searchTerm1.toLowerCase()),o=-1!==t.indexOf(this.searchTerm2.toLowerCase())||-1!==a.indexOf(this.searchTerm2.toLowerCase())||-1!==i.indexOf(this.searchTerm2.toLowerCase());return n&&l&&o})}},watch:{},data:()=>({searchTerm:"",searchTerm1:"",searchTerm2:""}),methods:{}},bs=hs,fs=Object(y["a"])(bs,os,rs,!1,null,null,null),vs=fs.exports;x()(fs,{VCol:dt["a"],VContainer:k["a"],VRow:mt["a"],VTextField:Jl["a"]});var ys={name:"SearchView",components:{FunctionSearch:vs},props:{},computed:{},watch:{},data:()=>({searchTerm:""}),methods:{}},gs=ys,xs=Object(y["a"])(gs,ns,ls,!1,null,null,null),ks=xs.exports;x()(xs,{VContainer:k["a"]});var Ns=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v("Settings")]),a("h2",{staticStyle:{color:"red"}},[e._v("Under Construction")]),a("hr"),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"table-policy-template",attrs:{ripple:""}},[e._v("\n      Table Policy Template\n    ")]),a("v-tab-item",{key:"table-policy-template"},[a("security-policy-settings")],1)],1)],1)},Cs=[],_s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("default-rls-using")],1)},Ts=[],Ss=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-toolbar",[a("v-btn",{attrs:{disabled:e.disabled},on:{click:e.save}},[e._v("Save")]),a("h2",[e._v("Default RLS Using Clause")])],1),a("v-textarea",{attrs:{"auto-grow":"","hide-details":"","background-color":"black"},model:{value:e.defaultRlsUsing,callback:function(t){e.defaultRlsUsing=t},expression:"defaultRlsUsing"}}),a("hr")],1)},Es=[],Ps={name:"DefaultRlsUsingClause",computed:{defaultDefaultRlsUsing(){return this.$store.state.defaultRlsUsing},disabled(){return this.defaultRlsUsing===this.defaultDefaultRlsUsing}},methods:{save(){this.$store.commit("updateDefaultRlsUsing",{defaultRlsUsing:this.defaultRlsUsing})},load(){this.defaultRlsUsing=this.defaultDefaultRlsUsing}},data(){return{defaultRlsUsing:null}},mounted(){this.load()}},Ds=Ps,Is=Object(y["a"])(Ds,Ss,Es,!1,null,null,null),ws=Is.exports;x()(Is,{VBtn:q["a"],VContainer:k["a"],VTextarea:ve["a"],VToolbar:ye["a"]});var Rs={name:"SecurityPolicySettings",components:{DefaultRlsUsing:ws},computed:{},methods:{},data(){return{}}},Os=Rs,Vs=Object(y["a"])(Os,_s,Ts,!1,null,null,null),$s=Vs.exports;x()(Vs,{VContainer:k["a"]});var As={name:"Settings",components:{SecurityPolicySettings:$s},props:{},computed:{},data:()=>({activeTab:null})},js=As,Fs=Object(y["a"])(js,Ns,Cs,!1,null,null,null),Ls=Fs.exports;x()(Fs,{VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var Gs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"ma-0":"","pa-0":""}},[a("constraints-and-indices-manager")],1)},qs=[],Us=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-container",{attrs:{"bkeepground-color":"blkeep"}},[a("v-tabs",{attrs:{dark:"","slider-color":"yellow"}},[e._l(e.managedSchemata,(function(t){return a("v-tab",{key:t.schemaName,attrs:{ripple:""}},[e._v("\n        "+e._s(t.schemaName)+"\n      ")])})),e._l(e.managedSchemata,(function(e){return a("v-tab-item",{key:e.schemaName},[a("constraints-and-indices",{attrs:{tableSchema:e.schemaName}})],1)})),a("v-tab",{key:"allSchemata",attrs:{ripple:""}},[e._v("\n        All Schemata\n      ")]),a("v-tab-item",{key:"allSchemata"},[a("constraints-and-indices")],1)],2)],1)],1)},Bs=[];const zs="AS_EXPECTED",Ms="NO_INDEX",Hs="UNEXPECTED_NAME",Qs="EXTRA_INDEX",Ws="green",Ks="yellow",Js="blue",Xs="red";var Ys={name:"ConstraintsAndIndicesManager",components:{ConstraintsAndIndices:Ji},methods:{columnIndexStatusColor(e){switch(e){case zs:return Ws;case Ms:return Ks;case Hs:return Js;case Qs:break}}},watch:{},computed:{policies(){return this.$store.state.policies},managedSchemata(){return this.$store.state.managedSchemata.sort((e,t)=>{return e.schemaName<t.schemaName?-1:1})},headers(){return[{text:"",sortable:!1},{text:"Table Name",sortable:!1},...this.statusMap.map(e=>{return{text:e.name,sortable:!1}})]}},data:()=>({mappedSchemata:[],statusMap:[{name:zs,columnIndexStatusColor:Ws,defaultActions:{}},{name:Ms,columnIndexStatusColor:Ks,defaultActions:{ack:!1,create:!1}},{name:Hs,columnIndexStatusColor:Js,defaultActions:{ack:!1,rename:!0}},{name:Qs,columnIndexStatusColor:Xs,defaultActions:{ack:!1,drop:!1}}]})},Zs=Ys,ec=Object(y["a"])(Zs,Us,Bs,!1,null,null,null),tc=ec.exports;x()(ec,{VCard:Ce["a"],VContainer:k["a"],VTab:Ee["a"],VTabItem:Pe["a"],VTabs:De["a"]});var ac={name:"ForeignKeyIndexView",components:{ConstraintsAndIndicesManager:tc},props:{},computed:{},data:()=>({activeTab:null})},ic=ac,nc=Object(y["a"])(ic,Gs,qs,!1,null,null,null),lc=nc.exports;x()(nc,{VContainer:k["a"]});var oc=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},rc=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("A tool to ensure that all "),a("a",{attrs:{href:"https://www.graphile.org/postgraphile/smart-comments/",target:"_blank"}},[e._v("smart comments")]),e._v(" are properly configured to support postgraphile")])])}],sc={name:"SmartCommentManager"},cc=sc,uc=Object(y["a"])(cc,oc,rc,!1,null,null,null),dc=uc.exports,mc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Export Project")]),a("v-toolbar",[a("v-btn",{on:{click:e.exportProject}},[e._v("Save")])],1),a("v-textarea",{attrs:{value:e.projectJson,"auto-grow":"",readonly:""}})],1)},pc=[],hc={name:"ExportProject",components:{},props:{},computed:{projectName(){return this.project?this.project.name:"N/A"},projectJson(){return JSON.stringify(this.$store.state,0,2)}},methods:{exportProject:function(){const e=this.projectJson,t=new Blob([e],{type:"text/plain"}),a=document.createEvent("MouseEvents"),i=document.createElement("a");i.download="pgdbi.json",i.href=window.URL.createObjectURL(t),i.dataset.downloadurl=["text/json",i.download,i.href].join(":"),a.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(a)}}},bc=hc,fc=Object(y["a"])(bc,mc,pc,!1,null,null,null),vc=fc.exports;x()(fc,{VBtn:q["a"],VTextarea:ve["a"],VToolbar:ye["a"]});var yc=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},gc=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Sqitch")])])}],xc={},kc=Object(y["a"])(xc,yc,gc,!1,null,null,null),Nc=kc.exports,Cc=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},_c=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("Graphile Worker")])])}],Tc={},Sc=Object(y["a"])(Tc,Cc,_c,!1,null,null,null),Ec=Sc.exports,Pc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},Dc=[],Ic={name:"Enum",components:{ScriptViewer:Rt["a"]},props:{id:{type:String,required:!0}},computed:{definition(){return this.ENUM.enumDefinition}},data:()=>({ENUM:{enumDefinition:"N/A"}}),methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setEnum(){const e=this.id.split(".")[0],t=this.$store.state.managedSchemata.find(t=>t.schemaName===e);this.ENUM=t.schemaEnums.find(e=>e.id===this.id)}},mounted(){this.setEnum()},beforeRouteUpdate(e,t,a){this.setEnum(),a()}},wc=Ic,Rc=Object(y["a"])(wc,Pc,Dc,!1,null,null,null),Oc=Rc.exports;x()(Rc,{VContainer:k["a"]});var Vc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("h1",[e._v(e._s(e.id))]),a("hr"),a("script-viewer",{attrs:{scriptText:e.definition,showDeclarationVisibility:!1,showReadability:!1,skipFormat:""}})],1)},$c=[],Ac={name:"Udt",components:{ScriptViewer:Rt["a"]},props:{id:{type:String,required:!0}},computed:{definition(){return this.UDT.udtDefinition}},data:()=>({UDT:{udtDefinition:"N/A"}}),methods:{onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},setUdt(){const e=this.id.split(".")[0],t=this.$store.state.managedSchemata.find(t=>t.schemaName===e);this.UDT=t.schemaUdts.find(e=>e.id===this.id)}},mounted(){this.setUdt()},beforeRouteUpdate(e,t,a){this.setUdt(),a()}},jc=Ac,Fc=Object(y["a"])(jc,Vc,$c,!1,null,null,null),Lc=Fc.exports;x()(Fc,{VContainer:k["a"]});var Gc=a("0e44"),qc=[{name:"graphile",dbOwnerRole:{roleName:"app_owner",applicableRoles:[]},dbAuthenticatorRole:{roleName:"app_authenticator",applicableRoles:[{roleName:"app_visitor"},{roleName:"app_anonymous"}]},dbUserRoles:[{roleName:"app_visitor",applicableRoles:[{roleName:"app_anonymous"}]},{roleName:"app_anonymous",applicableRoles:[]}]},{name:"multi-user",dbOwnerRole:{roleName:"app_owner",applicableRoles:[]},dbAuthenticatorRole:{roleName:"app_authenticator",applicableRoles:[{roleName:"app_super_admin"},{roleName:"app_admin"},{roleName:"app_user"},{roleName:"app_anonymous"}]},dbUserRoles:[{roleName:"app_super_admin",applicableRoles:[{roleName:"app_admin"},{roleName:"app_user"},{roleName:"app_anonymous"}]},{roleName:"app_admin",applicableRoles:[{roleName:"app_user"},{roleName:"app_anonymous"}]},{roleName:"app_user",applicableRoles:[{roleName:"app_anonymous"}]},{roleName:"app_anonymous",applicableRoles:[]}]}],Uc={allRoleSets:qc,pgdbiOptions:{},initializing:!0,schemaFilterOn:!0,policies:[],tablePolicyAssignments:{},functionPolicies:[],functionPolicyAssignments:{},defaultPolicy:null,defaultPolicyPermissive:null,defaultFunctionPolicy:null,defaultDbUserPolicies:[],genericIndexEvaluations:{},fkIndexEvaluations:{singleColumn:{},multiColumn:{}},uqIndexEvaluations:{singleColumn:{},multiColumn:{}},indicesToDrop:{},indexEvaluations:{},managedSchemata:[],parkedSchemata:[],rawSchemata:[],schemaFilter:[],roleSet:{dbOwnerRole:{},dbAuthenticatorRole:{},dbUserRoles:[]},defaultRlsUsing:"( owner_id = viewer_id() )",defaultRlsWithCheck:"",defaultRlsQualifiers:{all:{policies:[]},select:{policies:[]},insert:{policies:[]},update:{policies:[]},delete:{policies:[]}},defaultRoleGrants:{select:"DENIED",insert:"DENIED",update:"DENIED",delete:"DENIED"},defaultPermissiveRoleGrants:{select:"ALLOWED",insert:"ALLOWED",update:"ALLOWED",delete:"ALLOWED"},defaultImpliedRoleGrants:{select:"IMPLIED",insert:"IMPLIED",update:"IMPLIED",delete:"IMPLIED"},functionPolicyHeaderTemplate:"\n  ----------  BEGIN: {{schemaName}}.{{functionName}}\n  \n  ",functionPolicyFooterTemplate:"\n\n  ----------  END: {{schemaName}}.{{functionName}}",defaultFunctionRoleGrants:{execute:"DENIED"},defaultFunctionRoleGrantsPermissive:{execute:"ALLOWED"},defaultFunctionRoleGrantsImplied:{execute:"IMPLIED"}};function Bc(e){Object.keys(Uc).filter(e=>-1===["allRoleSets"].indexOf(e)).forEach(t=>{e[t]=Uc[t]})}var zc=Bc;function Mc(e){e.schemaFilterOn=!0}var Hc=Mc;function Qc(e,t){return{tableId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Wc(e,t){const a=t.tableIds,i=t.policyDefinitionId;a.forEach(t=>{e.tablePolicyAssignments[t]=Qc(t,i)})}var Kc=Wc;function Jc(e,t){return{functionId:e,policyDefinitionId:t,evaluation:{status:"PASS",errors:[]}}}function Xc(e,t){const a=t.functionIds,i=t.policyDefinitionId;a.forEach(t=>{e.functionPolicyAssignments[t]=Jc(t,i)})}var Yc=Xc;let Zc=1;function eu(){return Zc+=1,(new Date).getTime()*(1e4+Zc)+621355968e9}function tu(e){if(!e.defaultPolicy){const t={id:eu(),name:"Default Table Policy - NO ACCESS",policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.roleSet.dbUserRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRoleGrants}},{}),rlsQualifiers:e.roleSet.dbUserRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRlsQualifiers}},{})};e.defaultPolicy=t,e.policies=e.policies.concat([t])}}function au(e){if(!e.defaultPolicyPermissive){const t={id:eu(),name:"Default Table Policy - TOTAL EXPLICIT USER ACCESS",policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.roleSet.dbUserRoles.reduce((t,a)=>{return a.isAnonymous?{...t,[a.roleName]:e.defaultRoleGrants}:{...t,[a.roleName]:e.defaultPermissiveRoleGrants}},{}),rlsQualifiers:e.roleSet.dbUserRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRlsQualifiers}},{})};e.defaultPolicyPermissive=t,e.policies=e.policies.concat([t])}}function iu(e){if(0===e.defaultDbUserPolicies.length){const t=e.roleSet.dbUserRoles.map(t=>{return{id:eu(),name:`Default Table Policy - ${t.roleName}`,policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:e.roleSet.dbUserRoles.reduce((a,i)=>{let n;return n=i.roleName===t.roleName?e.defaultPermissiveRoleGrants:i.applicableRoles.map(e=>e.roleName).indexOf(t.roleName)>-1?e.defaultImpliedRoleGrants:e.defaultRoleGrants,{...a,[i.roleName]:n}},{}),rlsQualifiers:e.roleSet.dbUserRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRlsQualifiers}},{})}});e.defaultDbUserTablePolicies=t,e.policies=e.policies.concat(t)}}function nu(e){if(!e.defaultFunctionPolicy){const t={id:eu(),name:"Default Function Policy - NO ACCESS",functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:e.roleSet.dbUserRoles.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultFunctionRoleGrants}},{})};e.defaultFunctionPolicy=t,e.functionPolicies=e.functionPolicies.concat([t])}}function lu(e){if(0===e.defaultDbUserPolicies.length){const t=e.roleSet.dbUserRoles.map(t=>{return{id:eu(),name:`User Function Policy - ${t.roleName}`,functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:e.roleSet.dbUserRoles.reduce((a,i)=>{let n;return n=i.roleName===t.roleName?e.defaultFunctionRoleGrantsPermissive:i.applicableRoles.map(e=>e.roleName).indexOf(t.roleName)>-1?e.defaultFunctionRoleGrantsImplied:e.defaultFunctionRoleGrants,{...a,[i.roleName]:n}},{})}});e.defaultDbUserFunctionsPolicies=t,e.functionPolicies=e.functionPolicies.concat(t)}}function ou(e,t){const a=t.reduce((t,a)=>{return[...t,...a.schemaTables.filter(t=>void 0===e.tablePolicyAssignments[t.id]).map(e=>e.id)]},[]);Kc(e,{tableIds:a,policyDefinitionId:e.defaultPolicy.id})}function ru(e,t){const a=t.reduce((t,a)=>{return[...t,...a.schemaFunctions.filter(t=>void 0===e.functionPolicyAssignments[t.id]).map(e=>e.id)]},[]);Yc(e,{functionIds:a,policyDefinitionId:e.defaultFunctionPolicy.id})}function su(e,t){tu(e),au(e),iu(e),nu(e),lu(e),ou(e,t),ru(e,t),e.managedSchemata=t.sort((e,t)=>{return e.schemaName<t.schemaName?-1:e.schemaName>t.schemaName?1:0}),e.initializing=!1,e.schemaFilterOn=!1}var cu=su;function uu(e,t){e.defaultRlsUsing=t.defaultRlsUsing}var du=uu;function mu(e,t){e.defaultRlsWithCheck=t.defaultRlsWithCheck}var pu=mu;function hu(e,t){const a=e.policies.find(e=>e.name===t.name);if(a)throw new Error("A policy with this name already exists");{const a=t.name,i=e.roleSet.dbUserRoles,n={id:1e4*(new Date).getTime()+621355968e9,name:a,policyHeaderTemplate:e.policyHeaderTemplate,policyFooterTemplate:e.policyFooterTemplate,enableRls:!1,columnExclusionOverrides:{insert:[],update:[]},columnExclusions:{insert:{},update:{}},roleGrants:i.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRoleGrants}},{}),rlsQualifiers:i.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultRlsQualifiers}},{})};e.policies=[...e.policies,n].sort((function(e,t){return e.id<t.id}))}}var bu=hu;function fu(e,t){const a=e.policies.filter(e=>e.name!==t.policy.name);e.policies=[...a,t.policy].sort((e,t)=>{return e.id-t.id})}var vu=fu;function yu(e,t){const a=e.policies.find(e=>e.name===t.name);if(a)throw new Error("A policy with this name already exists");{const a=t.name,i=e.roleSet.dbUserRoles,n={id:1e4*(new Date).getTime()+621355968e9,name:a,functionPolicyHeaderTemplate:e.functionPolicyHeaderTemplate,functionPolicyFooterTemplate:e.functionPolicyFooterTemplate,roleFunctionGrants:i.reduce((t,a)=>{return{...t,[a.roleName]:e.defaultFunctionRoleGrants}},{})};e.functionPolicies=[...e.functionPolicies,n].sort((function(e,t){return e.id<t.id}))}}var gu=yu;function xu(e,t){const a=e.functionPolicies.filter(e=>e.id!==t.policy.id);e.functionPolicies=[...a,t.policy].sort((e,t)=>{return e.id-t.id})}var ku=xu;function Nu(e,t){const a=e.policies.find(e=>e.id===t.policyId),i=e.policies.filter(e=>e.id!==t.policyId),n=t.roleName,l=t.action,o=1e4*(new Date).getTime()+621355968e9,r={id:o,name:t.name||`rls_${o}`,using:t.using||e.defaultRlsUsing,withCheck:t.withCheck||e.defaultRlsWithCheck,passStrategy:t.passStrategy||"permissive"},s={...a,rlsQualifiers:{...a.rlsQualifiers,[n]:{...a.rlsQualifiers[n],[l]:{...a.rlsQualifiers[n][l],policies:[...a.rlsQualifiers[n][l].policies,r]}}}};e.policies=[...i,s]}var Cu=Nu;function _u(e,t){const a=e.policies.find(e=>e.id===t.policyId),i=e.policies.filter(e=>e.id!==t.policyId),n=t.roleName,l=t.action,o=t.rlsPolicyId,r={...a,rlsQualifiers:{...a.rlsQualifiers,[n]:{...a.rlsQualifiers[n],[l]:{...a.rlsQualifiers[n][l],policies:a.rlsQualifiers[n][l].policies.filter(e=>e.id!==o)}}}};e.policies=[...i,r]}var Tu=_u;function Su(e,t){Object.keys(t.project).forEach(a=>{e[a]=t.project[a]})}var Eu=Su;function Pu(e,t){const a=t.sourcePolicyDefinitionId,i=t.newFields,n=t.tableIds||[],l=e.policies.find(e=>e.id===a),o={...l,id:1e4*(new Date).getTime()+621355968e9,name:i.name,customIdentifier:1===n.length?n[0]:null};e.policies=[...e.policies,o].sort((function(e,t){return e.id<t.id})),Kc(e,{tableIds:n,policyDefinitionId:o.id})}var Du=Pu;function Iu(e,t){const a=t.policyDefinitionId,i=t.newFields,n=e.policies.find(e=>e.name===i.name);if(n)throw new Error("A policy with this name already exists");{const t=e.policies.find(e=>e.id===a),n=e.policies.filter(e=>e.id!==t.id),l={...t,name:i.name,customIdentifier:null};e.policies=[...n,l].sort((function(e,t){return e.id<t.id}))}}var wu=Iu;function Ru(e,t){const a=t.policyDefinitionId,i=e.policies.filter(e=>e.id!==a);e.policies=[...i].sort((function(e,t){return e.id<t.id})),Object.keys(e.tablePolicyAssignments).forEach(t=>{e.tablePolicyAssignments[t]===a&&(e.tablePolicyAssignments[t]=e.defaultPolicy.id)})}var Ou=Ru;function Vu(e,t){e.tablePolicyTemplate=t.tablePolicyTemplate}var $u=Vu,Au=a("83cd"),ju=a.n(Au);function Fu(e,t){e.pgdbiOptions=t.pgdbiOptions}var Lu=Fu;function Gu(e,t){const a=e.policies.find(e=>e.id===t.policyDefinitionId),i=e.policies.filter(e=>e.id!==t.policyDefinitionId);e.policies=[...i,{...a,name:t.name}]}var qu=Gu;function Uu(e,t){const a=e.allRoleSets.find(e=>e.name===t);e.roleSet=a}var Bu=Uu;function zu(e,t){e.allRoleSets=t}var Mu=zu,Hu={resetDefaultState:zc,filterSchemata:Hc,setManagedSchemata:cu,assignTablePolicy:Kc,defaultRlsUsing:du,defaultRlsWithCheck:pu,newPolicy:bu,savePolicy:vu,createRlsPolicy:Cu,deleteRlsPolicy:Tu,importProject:Eu,newFunctionPolicy:gu,saveFunctionPolicy:ku,assignFunctionPolicy:Yc,customizeTablePolicy:Du,makeGlobalTablePolicy:wu,deleteTablePolicy:Ou,updateTablePolicyTemplate:$u,updateDefaultRlsUsing:ju.a,setPgdbiOptions:Lu,renameTablePolicy:qu,setProjectRoleSet:Bu,setAllRoleSets:Mu};async function Qu({commit:e},t){return await e("resetDefaultState"),await e("setProjectRoleSet",t),`role set set - ${t}`}var Wu=Qu;async function Ku({commit:e},t){await e("setManagedSchemata",t.schemaTree),e("setPgdbiOptions",t.pgdbiOptions)}var Ju=Ku;async function Xu({commit:e}){await e("resetDefaultState")}var Yu=Xu,Zu={setProjectRoleSet:Wu,setManagedSchemata:Ju,resetDefaultState:Yu};i["a"].use(Vl["a"]);var ed=new Vl["a"].Store({plugins:[Object(Gc["a"])()],state:Uc,mutations:Hu,actions:Zu});i["a"].use(X["a"]);const td=new X["a"]({scrollBehavior(e,t,a){return a||{x:0,y:0}},routes:[{path:"/",name:"home",component:Ue},{path:"/initialize",name:"initialize",component:et},{path:"/role-manager",name:"role-manager",component:Ln},{path:"/security-manager",name:"security-manager",component:Xr},{path:"/pg-lint",name:"pg-lint",component:is},{path:"/search-view",name:"search-view",component:ks},{path:"/fk-index-manager",name:"fk-index-manager",component:lc},{path:"/smart-comment-manager",name:"smart-comment-manager",component:dc},{path:"/settings",name:"settings",component:Ls},{path:"/project-export",name:"project-export",component:vc},{path:"/project-import",name:"project-import",component:Je},{path:"/sqitch",name:"sqitch",component:Nc},{path:"/worker",name:"worker",component:Ec},{path:"/table/:id",name:"table",component:sn,props:!0},{path:"/view/:id",name:"view",component:xn,props:!0},{path:"/function/:id",name:"function",component:ni["a"],props:!0},{path:"/enum/:id",name:"enum",component:Oc,props:!0},{path:"/udt/:id",name:"udt",component:Lc,props:!0},{path:"/about",name:"about",component:()=>a.e("about").then(a.bind(null,"f820"))}]});td.beforeEach((e,t,a)=>{ed.state.initializing&&"initialize"!==e.name&&td.push("initialize"),a()});var ad=td,id=a("522d"),nd=a("efe7");i["a"].use(id["a"]);const ld="apollo-token",od=Object({NODE_ENV:"production",BASE_URL:"/pgdbi/"}).VUE_APP_GRAPHQL_HTTP||"/pgdbi/graphql",rd={httpEndpoint:od,tokenName:ld,persisting:!1,websocketsOnly:!1,ssr:!1};function sd(e={}){const{apolloClient:t}=Object(nd["createApolloClient"])({...rd,...e}),a=new id["a"]({defaultClient:t,defaultOptions:{$query:{}},errorHandler(e){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",e.message)}});return a}var cd=a("ca55");i["a"].config.productionTip=!1,i["a"].use(Sn.a),i["a"].use(cd["a"]),new i["a"]({vuetify:l,router:ad,store:ed,apolloProvider:sd(),render:e=>e(J)}).$mount("#app")},"58bb":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dbIntrospection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pgdbiOptions"},arguments:[],directives:[]}]}}],loc:{start:0,end:42}};a.loc.source={body:"query {\n  dbIntrospection\n  pgdbiOptions\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a},"7b59":function(e,t,a){"use strict";var i=a("8bda"),n=a.n(i);n.a},"82cd":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{key:e.policyDefinition.id,attrs:{color:"black"}},[a("v-container",[a("v-toolbar",[a("h1",[e._v("Name: "+e._s(e.policyDefinition.name))])]),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Execution Grants\n      ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("policy-definition-grant-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.aFunction?"Policy":"Policy Template")+"\n      ")]),a("v-tab-item",{key:"policy-template"},[a("v-card",{attrs:{flat:""}},[a("policy-realization",{attrs:{policyDefinition:e.policyDefinition,aFunction:e.aFunction}})],1)],1),e.aFunction?a("v-tab",{key:"function-definition",attrs:{ripple:""}},[e._v("\n        Function Definition\n      ")]):e._e(),e.aFunction?a("v-tab-item",{key:"function-definition"},[a("v-card",{attrs:{flat:""}},[a("function-definition",{attrs:{id:e.aFunction.id}})],1)],1):e._e()],1)],1)],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.execute",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"execute"),disabled:e.roleGrantDisabled(i,"execute")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"execute")}}})]}}])})},o=[];const r="ALLOWED",s="DENIED",c="IMPLIED";var u={name:"FunctionPolicyDefinitionGrantGrid",props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected(e,t){return[r,c].indexOf(e[t])>-1},roleGrantDisabled(e,t){return e[t]===c||this.disabled},toggleRoleGrant(e,t){if(!0===this.toggleCompleted)return void(this.toggleCompleted=!1);const a=this.policy.roleFunctionGrants[e][t],i=this.dbUserRoles.filter(t=>{return void 0!==t.applicableRoles.find(t=>t.roleName===e)}).reduce((e,t)=>{return e.concat(t.roleName)},[]),n={...this.policy,roleFunctionGrants:Object.keys(this.policy.roleFunctionGrants).reduce((n,l)=>{const o=i.indexOf(l)>-1,u=l===e;return{...n,[l]:Object.keys(this.policy.roleFunctionGrants[l]).reduce((e,i)=>{this.policy.roleFunctionGrants[l][i];let n;return n=i===t?u?a===r?s:r:o?a===r?s:c:this.policy.roleFunctionGrants[l][i]:"all"==i&&(o||u)&&a===r?s:this.policy.roleFunctionGrants[l][i],{...e,[i]:n}},{})}},{})};this.$store.commit("saveFunctionPolicy",{policy:n}),this.toggleCompleted=!0}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},grantMatrix(){return Object.keys(this.policy.roleFunctionGrants).map(e=>{return{...this.policy.roleFunctionGrants[e],roleName:e}})},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"EXECUTE",sortable:!1,value:"execute"}]}}},d=u,m=a("2877"),p=a("6544"),h=a.n(p),b=a("ac7c"),f=a("8fea"),v=Object(m["a"])(d,l,o,!1,null,null,null),y=v.exports;h()(v,{VCheckbox:b["a"],VDataTable:f["a"]});var g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},x=[],k=a("89d6"),N=a("4eb5"),C=a.n(N),_=a("0100"),T={name:"FunctionDefinition",mixins:[C.a],components:{ScriptViewer:k["a"]},props:{policyDefinition:{type:Object,required:!0},aFunction:{type:Object,required:!1}},data(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyDefinition(){this.doComputePolicy()},policyReadability(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},doComputePolicy(){const e=this.aFunction?{}:null;this.computedPolicy=Object(_["a"])(this.policyDefinition,this.policyReadability,e,this.aFunction)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},S=T,E=a("a523"),P=Object(m["a"])(S,g,x,!1,null,null,null),D=P.exports;h()(P,{VContainer:E["a"]});var I=a("243e");var w={name:"FunctionPolicyDefinition",components:{PolicyDefinitionGrantGrid:y,PolicyRealization:D,FunctionDefinition:I["a"]},props:{policyId:{type:Number,required:!0},aFunction:{type:Object,required:!1}},data(){return{calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:0}},mounted(){},watch:{},methods:{},computed:{disabled(){return null!==this.aFunction&&void 0!==this.aFunction||this.policyDefinition.id===this.$store.state.defaultFunctionPolicy.id},policyDefinition(){this.$store.state.functionPolicies;const e=this.$store.state.functionPolicies.find(e=>e.id===this.policyId);return e}}},R=w,O=a("b0af"),V=a("71a3"),$=a("c671"),A=a("fe57"),j=a("71d9"),F=Object(m["a"])(R,i,n,!1,null,null,null);t["a"]=F.exports;h()(F,{VCard:O["a"],VContainer:E["a"],VTab:V["a"],VTabItem:$["a"],VTabs:A["a"],VToolbar:j["a"]})},"83cd":function(e,t){function a(e,t){e.defaultRlsUsing=t.defaultRlsUsing}e.exports=a},"861c":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:"",cols:"12"}},[a("v-toolbar",{attrs:{dense:""}},[a("v-switch",{attrs:{label:"Enable RLS",disabled:e.disabled},model:{value:e.enableRls,callback:function(t){e.enableRls=t},expression:"enableRls"}}),a("v-spacer"),e.showMakeGlobalButton?a("table-policy-make-global-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),a("v-spacer"),e.showDeleteButton?a("table-policy-delete-dialog",{attrs:{policyDefinition:e.policyDefinition}}):e._e(),a("v-spacer"),a("h4",{staticClass:"text-no-wrap"},[e._v(e._s(e.title))]),a("v-spacer"),a("table-policy-rename-dialog",{attrs:{policyDefinition:e.policyDefinition}})],1),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n        Table Grants\n      ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-grants",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"rls",attrs:{ripple:"",disabled:!e.enableRls}},[e._v("\n        Row Level Security\n      ")]),a("v-tab-item",{key:"rls"},[a("v-card",{attrs:{flat:""}},[a("policy-rls-qualifier-grid",{attrs:{policy:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"policy-template",attrs:{ripple:""}},[e._v("\n        "+e._s(e.table?"Policy Script":"Policy Script Template")+"\n      ")]),a("v-tab-item",{key:"policy-template"},[a("v-card",{attrs:{flat:""}},[a("policy-realization",{attrs:{policyDefinition:e.policyDefinition,table:e.table,enableRls:e.enableRls}})],1)],1),e.table?a("v-tab",{key:"policy-evaluation",attrs:{ripple:""}},[e._v("\n        Evaluation\n      ")]):e._e(),e.table?a("v-tab-item",{key:"policy-evaluation"},[a("v-card",{attrs:{flat:""}},[a("table-policy-evaluator-detail",{attrs:{policyDefinition:e.policyDefinition,table:e.table}})],1)],1):e._e()],1)],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"grants",attrs:{ripple:""}},[e._v("\n    Role Grants\n  ")]),a("v-tab-item",{key:"grants"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-grant-grid",{attrs:{policyDefinition:e.policyDefinition,disabled:e.disabled}})],1)],1),a("v-tab",{key:"exclusions",attrs:{ripple:"",disabled:e.disabled}},[e._v("\n    Column Exclusions\n  ")]),a("v-tab-item",{key:"exclusions"},[a("v-card",{attrs:{flat:""}},[a("table-policy-definition-column-exclusions",{attrs:{policyDefinition:e.policyDefinition,table:e.table,disabled:e.disabled}})],1)],1)],1)},o=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{staticClass:"text-sm-left",attrs:{headers:e.headers,items:e.grantMatrix,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"item.select",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"select"),disabled:e.roleGrantDisabled(i,"select")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"select")}}})]}},{key:"item.insert",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"insert"),disabled:e.roleGrantDisabled(i,"insert")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"insert")}}})]}},{key:"item.update",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"update"),disabled:e.roleGrantDisabled(i,"update")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"update")}}})]}},{key:"item.delete",fn:function(t){var i=t.item;return[a("v-checkbox",{attrs:{"input-value":e.roleGrantSelected(i,"delete"),disabled:e.roleGrantDisabled(i,"delete")},on:{click:function(t){return e.toggleRoleGrant(i.roleName,"delete")}}})]}}])})},s=[];const c="ALLOWED",u="DENIED",d="IMPLIED";var m={name:"PolicyDefinitionGrantGrid",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1}},watch:{},methods:{roleGrantSelected(e,t){return[c,d].indexOf(e[t])>-1},roleGrantDisabled(e,t){return e[t]===d||this.disabled},toggleRoleGrant(e,t){if(!0===this.toggleCompleted)return void(this.toggleCompleted=!1);const a=this.policyDefinition.roleGrants[e][t],i=this.dbUserRoles.filter(t=>{return void 0!==(t.applicableRoles||[]).find(t=>t.roleName===e)}).reduce((e,t)=>{return e.concat(t.roleName)},[]),n={...this.policyDefinition,roleGrants:Object.keys(this.policyDefinition.roleGrants).reduce((n,l)=>{const o=i.indexOf(l)>-1,r=l===e;return{...n,[l]:Object.keys(this.policyDefinition.roleGrants[l]).reduce((e,i)=>{let n;return n=i===t?r?a===c?u:c:o?a===c?u:d:this.policyDefinition.roleGrants[l][i]:"all"==i&&(o||r)&&a===c?u:this.policyDefinition.roleGrants[l][i],{...e,[i]:n}},{})}},{})};this.$store.commit("savePolicy",{policy:n}),this.toggleCompleted=!0}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},grantMatrix(){return Object.keys(this.policyDefinition.roleGrants).map(e=>{return{...this.policyDefinition.roleGrants[e],roleName:e}})},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},p=m,h=a("2877"),b=a("6544"),f=a.n(b),v=a("ac7c"),y=a("8fea"),g=Object(h["a"])(p,r,s,!1,null,null,null),x=g.exports;f()(g,{VCheckbox:v["a"],VDataTable:y["a"]});var k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"justify-start":""}},[a("v-data-table",{attrs:{headers:e.headers,items:e.dataTableItems,"hide-default-footer":"",dense:""},scopedSlots:e._u([{key:"item.insertExclusions",fn:function(t){var i=t.item;return[a("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"insert",roleName:i.roleName}})]}},{key:"item.updateExclusions",fn:function(t){var i=t.item;return[a("column-exclusion-set",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:"update",roleName:i.roleName}})]}}])})],1)},N=[],C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e.overrideHidden?e._e():a("v-switch",{attrs:{label:"override implied exclusions"},model:{value:e.overrideActive,callback:function(t){e.overrideActive=t},expression:"overrideActive"}}),e.showDialogButton?a("table-policy-column-exclusion-dialog",{attrs:{policyDefinition:e.policyDefinition,table:e.table,action:e.action,roleName:e.roleName}}):e._e(),a("v-list",e._l(e.currentColumnExclusions,(function(t){return a("v-list-item",{key:t},[a("v-btn",{on:{click:function(a){return e.removeColumnExclusion(t)}}},[a("v-icon",[e._v("clear")])],1),e._v(" "+e._s(t)+"\n      ")],1)})),1)],1)},_=[],T=(a("2f62"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",hidden:e.hidden,disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Exclude Column")]),a("v-text-field",{model:{value:e.columnName,callback:function(t){e.columnName=t},expression:"columnName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.addColumnExclusion}},[e._v("Exclude")]),a("v-spacer")],1)],1)],1)],1)}),S=[],E={name:"TablePolicyColumnExclusionDialog",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0},disabled:{type:Boolean,required:!1}},data(){return{dialog:!1,columnName:""}},computed:{displayValue(){return`New ${this.action} exclusion`},hidden(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]}},watch:{},methods:{addColumnExclusion(){this.dialog=!1;const e=(this.policyDefinition.columnExclusions[this.action][this.roleName]||[]).filter(e=>e!==this.columnName).concat([this.columnName]);try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:{...this.policyDefinition.columnExclusions[this.action],[this.roleName]:e}}}})}catch(t){alert(t.toString()),console.error(t)}}}},P=E,D=(a("c2d7"),a("8336")),I=a("b0af"),w=a("99d9"),R=a("169a"),O=a("2fa4"),V=a("8654"),$=Object(h["a"])(P,T,S,!1,null,null,null),A=$.exports;f()($,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"],VTextField:V["a"]});var j={name:"ColumnExclusionSet",components:{TablePolicyColumnExclusionDialog:A},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},action:{type:String,required:!0},roleName:{type:String,required:!0}},data(){return{toggleCompleted:!1,overrideActive:!1}},watch:{overrideActive(){let e;const t=this.policyDefinition.columnExclusionOverrides[this.action].filter(e=>e!==this.roleName),a=this.overrideActive?t.concat(this.roleName):t;if(this.overrideActive)e=this.policyDefinition.columnExclusions[this.action];else{let{[this.roleName]:e,...t}=this.policyDefinition.columnExclusions[this.action]}try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusionOverrides:{...this.policyDefinition.columnExclusionOverrides,[this.action]:a},columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:e||{}}}})}catch(i){alert(i.toString()),console.error(i)}}},methods:{removeColumnExclusion(e){const t=this.policyDefinition.columnExclusions[this.action][this.roleName].filter(t=>t!==e);try{this.$store.commit("savePolicy",{policy:{...this.policyDefinition,columnExclusions:{...this.policyDefinition.columnExclusions,[this.action]:{...this.policyDefinition.columnExclusions[this.action],[this.roleName]:t}}}})}catch(a){alert(a.toString()),console.error(a)}}},mounted(){this.overrideActive=this.policyDefinition.columnExclusionOverrides[this.action].indexOf(this.roleName)>-1},computed:{currentColumnExclusions(){return(this.policyDefinition.columnExclusions[this.action]||[])[this.roleName]},disabled(){return"DENIED"===this.policyDefinition.roleGrants[this.roleName][this.action]},overrideHidden(){const e=["DENIED","ALLOWED"].indexOf(this.policyDefinition.roleGrants[this.roleName][this.action])>-1;return e},showDialogButton(){return!0}}},F=j,L=a("a523"),G=a("132d"),q=a("8860"),U=a("da13"),B=a("b73d"),z=Object(h["a"])(F,C,_,!1,null,null,null),M=z.exports;f()(z,{VBtn:D["a"],VContainer:L["a"],VIcon:G["a"],VList:q["a"],VListItem:U["a"],VSwitch:B["a"]});var H={name:"PolicyDefinitionColumnExclusions",components:{ColumnExclusionSet:M},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data(){return{toggleComplete:!1,headers:[{text:"Role Name",sortable:!1,value:"roleName"},{text:"Insert Exclusions",sortable:!1,value:"insertExclusions"},{text:"Update Exclusions",sortable:!1,value:"updateExclusions"}]}},watch:{},methods:{removeInsertExclusion(e,t){console.log("columnExclusion",e,t)}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},dataTableItems(){return Object.keys(this.policyDefinition.roleGrants).reduce((e,t)=>{const a=(this.policyDefinition.columnExclusions.insert||[])[t]||[],i=(this.policyDefinition.columnExclusions.update||[])[t]||[];return[...e,{roleName:t,insertColumnExclusions:a,updateColumnExclusions:i}]},[])}}},Q=H,W=Object(h["a"])(Q,k,N,!1,null,null,null),K=W.exports;f()(W,{VContainer:L["a"],VDataTable:y["a"]});var J={name:"PolicyDefinitionGrants",components:{TablePolicyDefinitionGrantGrid:x,TablePolicyDefinitionColumnExclusions:K},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},disabled:{type:Boolean,default:!1}},data(){return{activeTab:null}},watch:{},methods:{},computed:{}},X=J,Y=a("71a3"),Z=a("c671"),ee=a("fe57"),te=Object(h["a"])(X,l,o,!1,null,null,null),ae=te.exports;f()(te,{VCard:I["a"],VTab:Y["a"],VTabItem:Z["a"],VTabs:ee["a"]});var ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-data-table",{attrs:{headers:e.headers,items:e.rlsQualifierMatrix,"hide-default-footer":"","item-key":"id",dense:""},scopedSlots:e._u([{key:"item.roleName",fn:function(t){var i=t.item;return[a("div",{staticClass:"text-no-wrap"},[e._v(e._s(i.roleName))])]}},{key:"item.all",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"all",item:i,disabled:e.disabled}})]}},{key:"item.select",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"select",item:i,disabled:e.disabled}})]}},{key:"item.insert",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"insert",item:i,disabled:e.disabled}})]}},{key:"item.update",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"update",item:i,disabled:e.disabled}})]}},{key:"item.delete",fn:function(t){var i=t.item;return[a("table-policy-rls-action",{attrs:{policy:e.policy,action:"delete",item:i,disabled:e.disabled}})]}}])})},ne=[],le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-btn",{attrs:{small:"",hidden:e.disabled},on:{click:function(t){return e.addRlsPolicy(e.item.roleName,e.action)}}},[e._v("Add Policy")]),e._l(e.item[e.action].policies,(function(t){return a("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"ENABLED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})})),e._l(e.impliedPolicies(e.item.roleName,e.action),(function(t){return a("rls-policy-dialog",{key:t.roleName+"-"+t.id,attrs:{action:e.action,roleName:e.item.roleName,rlsPolicy:t,status:"IMPLIED",disableRlsPolicy:e.disableRlsPolicy,updateRlsPolicy:e.updateRlsPolicy,disabled:e.disabled}})}))],2)},oe=[],re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"1400"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.btnDisabled,hidden:e.hidden},on:{click:e.activate}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Rls Policy")]),a("v-text-field",{attrs:{label:"Name",disabled:e.disabled},model:{value:e.currentName,callback:function(t){e.currentName=t},expression:"currentName"}}),a("v-radio-group",{attrs:{column:!1,disabled:e.disabled},model:{value:e.currentPassStrategy,callback:function(t){e.currentPassStrategy=t},expression:"currentPassStrategy"}},[a("v-radio",{attrs:{label:"Permissive",value:"permissive"}}),a("v-radio",{attrs:{label:"Restrictive",value:"restrictive"}})],1),a("v-text-field",{attrs:{label:"Using",disabled:e.disabled},model:{value:e.currentUsing,callback:function(t){e.currentUsing=t},expression:"currentUsing"}}),a("v-text-field",{attrs:{label:"With Check",disabled:e.disabled},model:{value:e.currentWithCheck,callback:function(t){e.currentWithCheck=t},expression:"currentWithCheck"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.updateRlsPolicy(e.roleName,e.action,e.rlsPolicy.id,e.currentUsing,e.currentWithCheck,e.currentPassStrategy,e.currentName),e.dialog=!1}}},[e._v("Update")]),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.disableRlsPolicy(e.roleName,e.action,e.rlsPolicy.id),e.dialog=!1}}},[e._v("Disable")]),a("v-btn",{attrs:{hidden:e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{hidden:!e.disabled},on:{click:function(t){e.dialog=!1}}},[e._v("OK")]),a("v-spacer")],1)],1)],1)],1)},se=[];const ce="DISABLED",ue="IMPLIED";var de={name:"RlsPolicyDialog",props:{disabled:{type:Boolean,default:!1},status:{type:String,required:!0},rlsPolicy:{type:Object,required:!0},action:{type:String,required:!0},roleName:{type:String,required:!0},disableRlsPolicy:{type:Function,required:!0},updateRlsPolicy:{type:Function,required:!0}},data(){return{toggleCompleted:!1,dialog:!1,currentName:"n/a",currentUsing:"n/a",currentWithCheck:"n/a",currentPassStrategy:!1}},computed:{displayValue(){return this.rlsPolicy.name},rlsQualifierDisplayValueDisabled(){return!1},hidden(){return!1},btnDisabled(){return[ce,ue].indexOf(this.status)>-1}},watch:{},methods:{activate(){this.currentName=this.rlsPolicy.name,this.currentUsing=this.rlsPolicy.using,this.currentWithCheck=this.rlsPolicy.withCheck,this.currentPassStrategy=this.rlsPolicy.passStrategy}}},me=de,pe=(a("dbdb"),a("67b6")),he=a("43a6"),be=Object(h["a"])(me,re,se,!1,null,null,null),fe=be.exports;f()(be,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VRadio:pe["a"],VRadioGroup:he["a"],VSpacer:O["a"],VTextField:V["a"]});var ve={name:"PolicyRlsAction",components:{RlsPolicyDialog:fe},props:{policy:{type:Object,required:!0},action:{type:String,required:!0},item:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{}},watch:{},methods:{impliedPolicies(e,t){const a=this.dbUserRoles.find(t=>t.roleName===e).applicableRoles.reduce((e,t)=>{return e.concat(t.roleName)},[]).concat([e]),i=a.reduce((a,i)=>{return i!==e?"all"===t?a.concat(this.policy.rlsQualifiers[i][t].policies):a.concat(this.policy.rlsQualifiers[i][t].policies).concat(this.policy.rlsQualifiers[i].all.policies):"all"===t?a:a.concat(this.policy.rlsQualifiers[i].all.policies)},[]);return i},addRlsPolicy(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy(e,t,a){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:a})},updateRlsPolicy(e,t,a,i,n,l,o){const r=this.policy.rlsQualifiers[e][t].policies.filter(e=>e.id!==a).concat([{id:a,using:i,withCheck:n,passStrategy:l,name:o}]),s={...this.policy,rlsQualifiers:{...this.policy.rlsQualifiers,[e]:{...this.policy.rlsQualifiers[e],[t]:{status:this.policy.rlsQualifiers[e][t].status,policies:r,using:i,withCheck:n,passStrategy:l}}}};this.$store.commit("savePolicy",{policy:s})}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles}}},ye=ve,ge=(a("c496"),Object(h["a"])(ye,le,oe,!1,null,null,null)),xe=ge.exports;f()(ge,{VBtn:D["a"],VContainer:L["a"]});const ke="ENABLED",Ne="DISABLED",Ce="IMPLIED";var _e={name:"PolicyRlsQualifierGrid",components:{TablePolicyRlsAction:xe},props:{policy:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{toggleCompleted:!1,dialog:!1,currentUsing:"n/a",currentWithCheck:"n/a"}},watch:{},methods:{impliedPolicies(e,t){const a=this.dbUserRoles.find(t=>t.roleName===e).applicableRoles.reduce((e,t)=>{return e.concat(t.roleName)},[]).concat([e]),i=a.reduce((a,i)=>{return i!==e?"all"===t?a.concat(this.policy.rlsQualifiers[i][t].policies):a.concat(this.policy.rlsQualifiers[i][t].policies).concat(this.policy.rlsQualifiers[i].all.policies):"all"===t?a:a.concat(this.policy.rlsQualifiers[i].all.policies)},[]);return i},addRlsPolicy(e,t){this.$store.commit("createRlsPolicy",{policyId:this.policy.id,roleName:e,action:t})},disableRlsPolicy(e,t,a){this.$store.commit("deleteRlsPolicy",{policyId:this.policy.id,roleName:e,action:t,rlsPolicyId:a})},updateRlsPolicy(e,t,a,i,n,l,o){const r=this.policy.rlsQualifiers[e][t].policies.filter(e=>e.id!==a).concat([{id:a,using:i,withCheck:n,passStrategy:l,name:o}]),s={...this.policy,rlsQualifiers:{...this.policy.rlsQualifiers,[e]:{...this.policy.rlsQualifiers[e],[t]:{status:this.policy.rlsQualifiers[e][t].status,policies:r,using:i,withCheck:n,passStrategy:l}}}};this.$store.commit("savePolicy",{policy:s})},rlsQualifierCheckLabel(e,t){switch(e[t].status){case ke:return"Add Policy";case Ne:return"Enable";case Ce:return"Add Policy"}}},computed:{dbUserRoles(){return this.$store.state.roleSet.dbUserRoles},defaultRLSQual(){return this.$store.state.defaultRLSQual},rlsQualifierMatrix(){return Object.keys(this.policy.rlsQualifiers).map(e=>{return{...this.policy.rlsQualifiers[e],roleName:e}})},headers(){return[{text:"Role Name",sortable:!1,value:"roleName"},{text:"ALL",sortable:!1,value:"all"},{text:"SELECT",sortable:!1,value:"select"},{text:"INSERT",sortable:!1,value:"insert"},{text:"UPDATE",sortable:!1,value:"update"},{text:"DELETE",sortable:!1,value:"delete"}]}}},Te=_e,Se=(a("065f"),Object(h["a"])(Te,ie,ne,!1,null,null,null)),Ee=Se.exports;f()(Se,{VDataTable:y["a"]});var Pe=a("96b5"),De=a("bd5a"),Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Make Custom Policy Available Globally")]),a("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.makeGlobal}},[e._v("Make Global")]),a("v-spacer")],1)],1)],1)],1)},we=[],Re={name:"TablePolicyMakeGlobalDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){return{dialog:!1,customName:"New Table Policy"}},computed:{displayValue(){return"Make Global"}},watch:{},methods:{makeGlobal(){this.dialog=!1;try{this.$store.commit("makeGlobalTablePolicy",{policyDefinitionId:this.policyDefinition.id,newFields:{name:this.customName}})}catch(e){alert(e.toString()),console.error(e)}}}},Oe=Re,Ve=(a("cfbf"),Object(h["a"])(Oe,Ie,we,!1,null,null,null)),$e=Ve.exports;f()(Ve,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"],VTextField:V["a"]});var Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Delete Policy")]),a("h1",[e._v("Are you sure you want to delete this policy?")]),a("h2",[e._v("Any tables currently assigned this policy will revert to:")]),a("h2",[e._v("Default Policy - NO ACCESS")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.deleteDisabled},on:{click:e.deleteTablePolicyDefinition}},[e._v("Delete")]),a("v-spacer")],1)],1)],1)],1)},je=[],Fe={name:"TablePolicyDeleteDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},mounted(){},data(){return{dialog:!1}},computed:{displayValue(){return"Delete"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},deleteDisabled(){return!1}},watch:{},methods:{deleteTablePolicyDefinition(){this.dialog=!1,this.$store.commit("deleteTablePolicy",{policyDefinitionId:this.policyDefinition.id})}}},Le=Fe,Ge=(a("fb68"),Object(h["a"])(Le,Ae,je,!1,null,null,null)),qe=Ge.exports;f()(Ge,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"]});var Ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Rename Policy")]),a("v-text-field",{model:{value:e.policyName,callback:function(t){e.policyName=t},expression:"policyName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{attrs:{disabled:e.renameDisabled},on:{click:e.renameTablePolicyDefinition}},[e._v("Rename")]),a("v-spacer")],1)],1)],1)],1)},Be=[],ze={name:"TablePolicyRenameDialog",props:{policyDefinition:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},mounted(){},data(){return{dialog:!1,policyName:""}},computed:{displayValue(){return"Rename"},allPolicyDefinitions(){return this.$store.state.policies.filter(e=>!e.customIdentifier)},renameDisabled(){return!1}},watch:{},methods:{renameTablePolicyDefinition(){this.dialog=!1,this.$store.commit("renameTablePolicy",{policyDefinitionId:this.policyDefinition.id,name:this.policyName})}},mounted(){this.policyName=this.policyDefinition.name}},Me=ze,He=(a("c5a9"),Object(h["a"])(Me,Ue,Be,!1,null,null,null)),Qe=He.exports;f()(He,{VBtn:D["a"],VCard:I["a"],VCardActions:w["a"],VCardTitle:w["c"],VDialog:R["a"],VSpacer:O["a"],VTextField:V["a"]});var We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-textarea",{attrs:{value:e.tablePolicyEval,"auto-grow":"","hide-details":"","background-color":"black",disabled:""}}),a("v-data-table",{attrs:{headers:e.headers,items:e.tablePolicyEvaluationItems,"hide-default-footer":"","item-key":"id"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("tr",[a("td",[e._v("\n          "+e._s(t.item.roleName)+"\n        ")]),a("td",[e._v("\n          "+e._s(t.item.action)+"\n        ")]),a("td",[e._v("\n          "+e._s(t.item.status)+"\n        ")])])]}}])})],1)},Ke=[],Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},Xe=[];const Ye="ALLOWED",Ze="DENIED",et="IMPLIED";var tt={name:"TablePolicyEvaluatorCalculator",props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!0}},mounted(){},data(){return{}},computed:{grantStatusColors(){return{expected:"green",missing:"yellow",unexpected:"red",extra:"blue"}},tablePolicyEvaluation(){const e=this.$store.state.ignoredRoles.map(e=>e.roleName),t=Object.keys(this.policyDefinition.roleGrants).reduce((t,a)=>{return Object.keys(this.policyDefinition.roleGrants[a]).filter(t=>-1===e.indexOf(t)).reduce((e,t)=>{const i=this.policyDefinition.roleGrants[a][t],n=this.table.roleTableGrants.find(e=>e.grantee===a&&e.privilegeType===t.toUpperCase());switch(i){case Ye:return n?{...e,expected:[...e.expected,{...n,statusColor:this.grantStatusColors.expected}]}:{...e,missing:[...e.missing,{roleName:a,expectedRoleAction:i,action:t,statusColor:this.grantStatusColors.missing}]};case Ze:return n?{...e,unexpected:[...e.unexpected,{...n,statusColor:this.grantStatusColors.unexpected}]}:e;case et:return n?{...e,extra:[...e.extra,{...n,statusColor:this.grantStatusColors.extra}]}:e}},t)},{expected:[],missing:[],extra:[],unexpected:[]});return t}},watch:{},methods:{}},at=tt,it=(a("9498"),Object(h["a"])(at,Je,Xe,!1,null,null,null)),nt=it.exports,lt={name:"TablePolicyEvaluatorDetail",mixins:[nt],props:{},mounted(){},data(){return{headers:[{text:"roleName",sortable:!1},{text:"action",sortable:!1},{text:"status",sortable:!1}]}},computed:{tablePolicyEval(){return JSON.stringify(this.tablePolicyEvaluation,0,2)},tablePolicyEvaluationItems(){return Object.keys(this.tablePolicyEvaluation).reduce((e,t)=>{return[...e,...this.tablePolicyEvaluation[t].map(e=>{return{...e,id:`${e.roleName}-${e.action}`,status:t}})]},[])}}},ot=lt,rt=(a("7b59"),a("a844")),st=Object(h["a"])(ot,We,Ke,!1,null,null,null),ct=st.exports;f()(st,{VContainer:L["a"],VDataTable:y["a"],VTextarea:rt["a"]});var ut={name:"PolicyDefinition",components:{PolicyRlsQualifierGrid:Ee,PolicyRealization:Pe["a"],TablePolicyCustomizeDialog:De["a"],TablePolicyMakeGlobalDialog:$e,TablePolicyDeleteDialog:qe,TablePolicyEvaluatorDetail:ct,TablePolicyDefinitionGrants:ae,TablePolicyRenameDialog:Qe},props:{policyId:{type:Number,required:!0},table:{type:Object,required:!1}},data(){return{enableRls:!0,policyStructure:[],calculatedPolicy:"NOT CALCULATED",toggleCompleted:!1,activeTab:null}},mounted(){this.enableRls=this.policyDefinition.enableRls},watch:{policyDefinition(){this.enableRls=this.policyDefinition.enableRls},enableRls(){this.$store.commit("savePolicy",{policy:{...this.policyDefinition,enableRls:this.enableRls}}),this.enableRls||1!==this.activeTab||(this.activeTab=0)}},methods:{customize(){this.table.name}},computed:{showDeleteButton(){this.policyDefinition.id===this.$store.state.defaultPolicy.id||(this.policyDefinition.id,this.$store.state.defaultPolicyPermissive.id)},showMakeGlobalButton(){return void 0!==this.policyDefinition.customIdentifier&&null!==this.policyDefinition.customIdentifier},showCustomizeButton(){return!!this.table&&!this.policyDefinition.customIdentifier},disabled(){const e=this.policyDefinition.id===this.$store.state.defaultPolicy.id||this.policyDefinition.id===this.$store.state.defaultPolicyPermissive.id,t=null!==this.table&&void 0!==this.table,a=!!this.policyDefinition.customIdentifier;return!!e||!!t&&!a},policyDefinition(){this.$store.state.policies;const e=this.$store.state.policies.find(e=>e.id===this.policyId);return e},title(){return`Policy Name: ${this.policyDefinition.name}`}}},dt=ut,mt=a("71d9"),pt=Object(h["a"])(dt,i,n,!1,null,null,null);t["a"]=pt.exports;f()(pt,{VCard:I["a"],VContainer:L["a"],VSpacer:O["a"],VSwitch:B["a"],VTab:Y["a"],VTabItem:Z["a"],VTabs:ee["a"],VToolbar:mt["a"]})},8930:function(e,t,a){},"89d6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[e.showToolbar?a("v-toolbar",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.scriptText,expression:"scriptText",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},i),[a("v-icon",[e._v("file_copy")]),e._v("Copy\n      ")],1)]}}],null,!1,1252371525)},[a("span",[e._v("Copy")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({attrs:{disabled:!e.canExecute},on:{click:e.executeSql}},i),[a("v-icon",[e._v("arrow_forward")]),e._v("Execute")],1)]}}],null,!1,1383927633)},[a("span",[e._v("Execute")])]),a("v-spacer"),a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-spacer"),a("v-spacer"),e.showReadability?a("v-layout",[a("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("terseÂ ")]),a("v-switch",{attrs:{"true-value":"verbose","false-value":"terse",label:"verbose"},model:{value:e.readability,callback:function(t){e.readability=t},expression:"readability"}})],1):e._e(),e.showDeclarationVisibility?a("v-layout",[a("label",{staticClass:"v-label theme--dark",attrs:{"mt-2":""}},[e._v("show declaration:Â ")]),a("v-switch",{attrs:{"true-value":"hide","false-value":"show",label:"hide"},model:{value:e.declarationVisibility,callback:function(t){e.declarationVisibility=t},expression:"declarationVisibility"}})],1):e._e()],1)],1)],1):e._e(),a("v-tabs",{attrs:{dark:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"the-script",attrs:{ripple:""}},[e._v("\n      Script\n    ")]),a("v-tab-item",{key:"the-script"},[a("v-textarea",{attrs:{disabled:!e.canEdit,value:e.formatScript(e.scriptText),"auto-grow":"",spellcheck:"false","background-color":"black"}})],1),e.results?a("v-tab",{key:"exec-result",attrs:{ripple:""}},[e._v("\n      Execute Result\n    ")]):e._e(),e.results?a("v-tab-item",{key:"exec-result"},[a("v-textarea",{attrs:{disabled:!e.canEdit,value:e.results,"auto-grow":"",spellcheck:"false","background-color":"black"}})],1):e._e()],1)],1)},n=[],l=a("3c04"),o=a.n(l),r={name:"ScriptViewer",components:{},props:{scriptText:{type:String,required:!1},showReadability:{type:Boolean,default:!0},showDeclarationVisibility:{type:Boolean,default:!1},showToolbar:{type:Boolean,default:!0},skipFormat:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!1},canExecute:{type:Boolean,default:!1}},computed:{},watch:{readability(){this.$emit("readability-changed",this.readability)},declarationVisibility(){this.$emit("declaration-visibility-changed",this.declarationVisibility)}},methods:{formatScript(e){return this.skipFormat?e:(e||"").toLowerCase().split(" exists").join(" exists\n  ").split(" on").join("\non").split(" using").join("\nusing").split(" (").join(" (\n  ").split(",").join("\n  ,").split(");").join("\n);")},handleCopyStatus(e){alert(e)},onCopy(){alert("Copied!")},onError(e){alert("Failed to copy script to clipboard"),console.error(e)},executeSql(){this.$apollo.mutate({mutation:o.a,variables:{sql:this.scriptText}}).then(e=>{console.log("result",e),this.activeTab=1,this.results=JSON.stringify(e.data.ExecSql.result,null,2)}).catch(e=>{this.activeTab=1,this.results=e.toString()})}},data:()=>({activeTab:0,allPolicies:[],results:null,schemaPolicy:"NOT CALCULATED",defaultRlsPolicies:"NOT CALCULATED",defaultNoRlsPolicies:"NOT CALCULATED",selectedTabName:"",readability:"terse",declarationVisibility:"show"})},s=r,c=a("2877"),u=a("6544"),d=a.n(u),m=a("8336"),p=a("a523"),h=a("132d"),b=a("a722"),f=a("0fd9"),v=a("2fa4"),y=a("b73d"),g=a("71a3"),x=a("c671"),k=a("fe57"),N=a("a844"),C=a("71d9"),_=a("3a2f"),T=Object(c["a"])(s,i,n,!1,null,null,null);t["a"]=T.exports;d()(T,{VBtn:m["a"],VContainer:p["a"],VIcon:h["a"],VLayout:b["a"],VRow:f["a"],VSpacer:v["a"],VSwitch:y["a"],VTab:g["a"],VTabItem:x["a"],VTabs:k["a"],VTextarea:N["a"],VToolbar:C["a"],VTooltip:_["a"]})},"8bda":function(e,t,a){},"8c37":function(e,t,a){"use strict";var i=a("22b5"),n=a.n(i);n.a},"90d0":function(e,t,a){},9270:function(e,t,a){},9498:function(e,t,a){"use strict";var i=a("9270"),n=a.n(i);n.a},"96b5":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("script-viewer",{attrs:{scriptText:e.computedPolicy,skipFormat:"",canExecute:""},on:{"readability-changed":e.policyReadabilityChanged}})],1)},n=[],l=a("89d6"),o=a("4eb5"),r=a.n(o),s=a("c92d"),c={name:"TablePolicyRealization",mixins:[r.a],components:{ScriptViewer:l["a"]},props:{policyDefinition:{type:Object,required:!0},table:{type:Object,required:!1},enableRls:{type:Boolean,required:!1}},data(){return{policyStructure:[],policyReadability:"terse",computedPolicy:"N/A"}},mounted(){this.doComputePolicy()},watch:{policyReadability(){this.doComputePolicy()},enableRls(){this.doComputePolicy()},policyDefinition(){this.doComputePolicy()}},methods:{policyReadabilityChanged(e){this.policyReadability=e},refresh(){this.doComputePolicy()},expand(){this.computedPolicy=`${this.computedPolicy} `},doComputePolicy(){let e=null;this.table&&(e={schemaName:this.table.tableSchema,tableName:this.table.tableName}),this.computedPolicy=Object(s["a"])(this.policyDefinition,this.policyReadability,e,this.table)},onCopy:function(e){alert("Copied!")},onError:function(e){alert("Failed to copy texts")},executeSql(){alert("not implemented:  server config value will expose graphile extension to execute generated script")}},computed:{}},u=c,d=a("2877"),m=a("6544"),p=a.n(m),h=a("a523"),b=Object(d["a"])(u,i,n,!1,null,null,null);t["a"]=b.exports;p()(b,{VContainer:h["a"]})},9969:function(e,t,a){"use strict";var i=a("1004"),n=a.n(i);n.a},"9e46":function(e,t,a){},a789:function(e,t,a){"use strict";var i=a("3b45"),n=a.n(i);n.a},a985:function(e,t,a){"use strict";(function(e){var i=a("861c");t["a"]={name:"PolicyManager",components:{PolicyDefinition:i["a"]},methods:{saveNewPolicy(){try{this.$store.commit("newPolicy",{name:this.newPolicyName})}catch(e){alert(e.toString()),console.error(e)}this.dialog=!1}},computed:{policies(){return this.$store.state.policies.sort((function(e,t){return e.id<t.id?-1:1}))}},data(){return{dialog:!1,newPolicyName:"New Table Policy",headers:[{text:""},{text:"ID",sortable:!1,value:"id"},{text:"Name",sortable:!1,value:"name"}]}},mounted(){e.client&&window&&(window.history.scrollRestoration="auto")}}}).call(this,a("f28c"))},ab3b:function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SearchFunctions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"searchFunctions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"searchTerm"},value:{kind:"Variable",name:{kind:"Name",value:"searchTerm"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"functionSchema"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resultDataType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"argumentDataTypes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"definition"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:201}};a.loc.source={body:"mutation SearchFunctions(\n  $searchTerm: String!\n){\n  searchFunctions(searchTerm: $searchTerm) {\n    id\n    functionName\n    functionSchema\n    resultDataType\n    argumentDataTypes\n    definition\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var n={};function l(e,t){for(var a=0;a<e.definitions.length;a++){var i=e.definitions[a];if(i.name&&i.name.value==t)return i}}function o(e,t){var a={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var i=n[t]||new Set,o=new Set,r=new Set;i.forEach((function(e){r.add(e)}));while(r.size>0){var s=r;r=new Set,s.forEach((function(e){if(!o.has(e)){o.add(e);var t=n[e]||new Set;t.forEach((function(e){r.add(e)}))}}))}return o.forEach((function(t){var i=l(e,t);i&&a.definitions.push(i)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),n[e.name.value]=t}}))})(),e.exports=a,e.exports["SearchFunctions"]=o(a,"SearchFunctions")},b450:function(e,t,a){},bd5a:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-dialog",{attrs:{persistent:"",width:"800"},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"text-none",attrs:{small:"",dark:"",disabled:e.disabled}},i),[e._v("\n        "+e._s(e.displayValue)+"\n      ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Custom Policy")]),a("v-text-field",{model:{value:e.customName,callback:function(t){e.customName=t},expression:"customName"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{on:{click:function(t){e.dialog=!1}}},[e._v("Cancel")]),a("v-btn",{on:{click:e.customizeTablePolicyDefinition}},[e._v("Customize")]),a("v-spacer")],1)],1)],1)],1)},n=[],l={name:"PolicyCustomizeDialog",props:{currentPolicyDefinition:{type:Object,required:!0},tables:{type:Array,required:!0},bulkCustomize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},mounted(){this.customName=this.defaultCustomName},data(){return{dialog:!1,customName:"n/a"}},computed:{displayValue(){return this.bulkCustomize?"Bulk Customize":"Customize"},defaultCustomName(){return 1===this.tables.length?`Custom Policy: ${this.tables[0].tableSchema}.${this.tables[0].tableName}`:this.tables.length>1?"New Bulk Policy":"n/a"}},watch:{},methods:{customizeTablePolicyDefinition(){this.dialog=!1;const e=this.tables.reduce((e,t)=>{return e.concat([t.id])},[]);this.$store.commit("customizeTablePolicy",{sourcePolicyDefinitionId:this.currentPolicyDefinition.id,tableIds:e,newFields:{name:this.customName}}),this.$emit("policyAssigned",this.tables)}}},o=l,r=(a("0134"),a("2877")),s=a("6544"),c=a.n(s),u=a("8336"),d=a("b0af"),m=a("99d9"),p=a("169a"),h=a("2fa4"),b=a("8654"),f=Object(r["a"])(o,i,n,!1,null,null,null);t["a"]=f.exports;c()(f,{VBtn:u["a"],VCard:d["a"],VCardActions:m["a"],VCardTitle:m["c"],VDialog:p["a"],VSpacer:h["a"],VTextField:b["a"]})},bd75:function(e,t,a){},c2d7:function(e,t,a){"use strict";var i=a("fe5d"),n=a.n(i);n.a},c496:function(e,t,a){"use strict";var i=a("bd75"),n=a.n(i);n.a},c5a9:function(e,t,a){"use strict";var i=a("8930"),n=a.n(i);n.a},c92d:function(e,t,a){"use strict";var i=a("9dbb"),n=a.n(i);const l="ALLOWED",o="DENIED",r="IMPLIED",s="terse";function c(e,t,a,i){const c=Object.keys(e.roleGrants).map(e=>{return{roleName:e}}),d=`${c.map(e=>e.roleName).join(", ")}`,m=Object.keys(e.roleGrants).reduce((t,a)=>{const n=Object.keys(e.roleGrants[a]).reduce((t,i)=>{return e.roleGrants[a][i]===l?t+1:t},0),o=Object.keys(e.roleGrants[a]).map((t,o,r)=>{switch(t){case"insert":case"update":let r=e.columnExclusions[t][a]||[],s=r.length>0?`\n        -- excluded columns: ${r.join(", ")}`:"\n        -- no excluded columns",c=i?`( ${i.tableColumns.map(e=>e.columnName).filter(e=>-1===r.indexOf(e)).join(", ")} )`:"{{grantColumns}}";const u=e.columnExclusionOverrides[t].indexOf(a)>-1,d=r.length>0||u?l:e.roleGrants[a][t];return{action:t,value:d,grantColumns:c,columnExclusionsText:s,comma:o<n-1?",":""};default:return{action:t,value:e.roleGrants[a][t],grantColumns:"",comma:o<n-1?",":""}}});return[...t,{roleName:a,grants:o}]},[]),p=m.map((e,t,a)=>{return{...e,grants:e.grants.filter(e=>e.value===l)}}).filter(e=>e.grants.length>0),h=m.map(e=>{return{...e,grants:e.grants.filter(e=>e.value===o)}}).filter(e=>e.grants.length>0),b=m.map(e=>{return{...e,grants:e.grants.filter(e=>e.value===r)}}).filter(e=>e.grants.length>0),f=Object.keys(e.rlsQualifiers).reduce((t,a)=>{return t.concat(Object.keys(e.rlsQualifiers[a]).reduce((t,i)=>{return[...t,...e.rlsQualifiers[a][i].policies.map(e=>{return{...e,action:i,roleName:a}})]},[]))},[]),v={verbose:!0,deniedRoleGrants:h,impliedRoleGrants:b},y={...a,policyName:e.name,enableRls:e.enableRls,allowedRoleGrants:p,rlsPolicies:f,revokeRolesList:d,tableName:(i||{}).tableName},g=t===s?y:{...v,...y};return n.a.render(u,g)}t["a"]=c;const u="\n----------\n----------  BEGIN TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n----------  POLICY NAME:  {{policyName}}\n----------\n\n----------  REMOVE EXISTING TABLE GRANTS\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from public;\n\n  revoke all privileges \n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  from {{revokeRolesList}};\n\n{{#enableRls}}\n----------  ENABLE ROW LEVEL SECURITY\n\n  ----------\n  ----------  remove all rls policies for table\n  ----------\n  DO\n  $body$\n    DECLARE \n      _pol pg_policies;\n      _drop_sql text;\n    BEGIN\n\n      for _pol in\n        select \n          *\n        from pg_policies\n        where schemaname = '{{schemaName}}'\n        and tablename = '{{tableName}}'\n      loop\n        _drop_sql := 'drop policy if exists ' || quote_ident(_pol.policyname) || ' on ' || quote_ident(_pol.schemaname) || '.' || quote_ident(_pol.tablename) || ';';\n        execute _drop_sql;\n      end loop\n      ;\n    END\n  $body$;\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} enable row level security;\n\n{{#rlsPolicies}}\n  create policy {{name}}_{{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}_{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n    on {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n    as {{passStrategy}}\n    for {{action}}\n    to {{roleName}}\n    using {{{using}}}\n    {{#withCheck}}\n    with check {{withCheck}}\n    {{/withCheck}}\n    ;\n{{/rlsPolicies}}\n\n{{/enableRls}}\n{{^enableRls}}\n----------  DISABLE ROW LEVEL SECURITY\n\n  alter table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} disable row level security;\n{{/enableRls}}\n\n----------  CREATE NEW TABLE GRANTS\n{{#allowedRoleGrants}}\n\n----------  {{roleName}}\n  grant \n  {{#grants}}\n    {{action}} {{grantColumns}}{{comma}} {{columnExclusionsText}}\n  {{/grants}}\n  on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} \n  to {{roleName}};\n\n{{/allowedRoleGrants}}\n\n{{#verbose}}\n----------  IMPLIED TABLE GRANTS\n  {{#impliedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --IMPLIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/impliedRoleGrants}}\n\n  ----------  DENIED TABLE GRANTS\n  {{#deniedRoleGrants}}\n\n  ----------  {{roleName}}\n  {{#grants}}\n  --DENIED:   grant {{action}} on table {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}} to {{roleName}};\n  {{/grants}}\n  {{/deniedRoleGrants}}\n{{/verbose}}\n\n----------  END TABLE POLICY: {{schemaName}}{{^schemaName}}{{=<% %>=}}{{schemaName}}<%={{ }}=%>{{/schemaName}}.{{tableName}}{{^tableName}}{{=<% %>=}}{{tableName}}<%={{ }}=%>{{/tableName}}\n--=="},cb8a:function(e,t,a){"use strict";var i=a("3754"),n=a.n(i);n.a},cfbf:function(e,t,a){"use strict";var i=a("015f"),n=a.n(i);n.a},d806:function(e,t,a){},da37:function(e,t,a){},dbdb:function(e,t,a){"use strict";var i=a("f010"),n=a.n(i);n.a},f010:function(e,t,a){},fb68:function(e,t,a){"use strict";var i=a("90d0"),n=a.n(i);n.a},fe5d:function(e,t,a){}});
//# sourceMappingURL=app.5296ba9b.js.map